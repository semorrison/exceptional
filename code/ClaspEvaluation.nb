(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     62083,       1800]
NotebookOptionsPosition[     59659,       1717]
NotebookOutlinePosition[     60038,       1734]
CellTagsIndexPosition[     59995,       1731]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
  "KnotTheoryPath", " ", "=", " ", "\"\<~/projects/KnotTheory/trunk/\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"$Path", ",", " ", "KnotTheoryPath"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", " ", "KnotTheory`"}]}], "Input",
 CellChangeTimes->{{3.475622342953959*^9, 3.475622351317061*^9}, {
  3.475622403169737*^9, 3.475622403749196*^9}, {3.593479351667861*^9, 
  3.59347937668596*^9}}],

Cell[BoxData["\<\"Loading KnotTheory` version of February 5, 2013, \
3:48:46.4762.\\nRead more at http://katlas.org/wiki/KnotTheory.\"\>"], "Print",\

 CellChangeTimes->{3.593479377311133*^9, 3.5934991350253773`*^9, 
  3.593501726444273*^9, 3.593503313767929*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PD", "[", 
  RowBox[{"Knot", "[", 
   RowBox[{"3", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5934793869665623`*^9, 3.5934793893050222`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"KnotTheory", "::", "loading"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Loading precomputed data in \
\[NoBreak]\\!\\(\\\"PD4Knots`\\\"\\)\[NoBreak].\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.593499137312025*^9, 3.593501727041799*^9, 
  3.593503314246162*^9}],

Cell[BoxData[
 RowBox[{"PD", "[", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", "4", ",", "2", ",", "5"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"3", ",", "6", ",", "4", ",", "1"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"5", ",", "2", ",", "6", ",", "3"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.593479389872448*^9, 3.593499137313525*^9, 
  3.593501727114558*^9, 3.593503314288436*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"threeTwistIdentity", "=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "v"], 
    SuperscriptBox["Twist", "3"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SuperscriptBox["w", "2"], "v"], "-", "1", "+", 
      FractionBox["v", 
       SuperscriptBox["w", "2"]]}], ")"}], 
    SuperscriptBox["Twist", "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SuperscriptBox["w", "2"], "v"], "-", "v", "+", 
      FractionBox["v", 
       SuperscriptBox["w", "2"]]}], ")"}], "Twist"}], "+", "v", " ", "-", 
   RowBox[{
    SuperscriptBox["v", "18"], 
    FractionBox[
     RowBox[{
      RowBox[{"bracket", "[", "\[Lambda]", "]"}], 
      RowBox[{"bracket", "[", 
       RowBox[{"\[Lambda]", "-", "1"}], "]"}], 
      RowBox[{"brace", "[", "6", "]"}]}], 
     RowBox[{"brace", "[", "2", "]"}]], "CupCap"}], "+", 
   RowBox[{
    SuperscriptBox["v", "9"], 
    RowBox[{"bracket", "[", "1", "]"}], "Iweb"}]}]}]], "Input",
 CellChangeTimes->{{3.59347954976357*^9, 3.5934796660830708`*^9}, {
   3.5934799717082663`*^9, 3.593479990906011*^9}, 3.593480054230073*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["Twist", "3"], "v"], "+", "v", "-", 
  RowBox[{
   SuperscriptBox["Twist", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox["v", 
      SuperscriptBox["w", "2"]], "+", 
     FractionBox[
      SuperscriptBox["w", "2"], "v"]}], ")"}]}], "-", 
  RowBox[{"Twist", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "v"}], "+", 
     FractionBox["v", 
      SuperscriptBox["w", "2"]], "+", 
     FractionBox[
      SuperscriptBox["w", "2"], "v"]}], ")"}]}], "+", 
  RowBox[{"Iweb", " ", 
   SuperscriptBox["v", "9"], " ", 
   RowBox[{"bracket", "[", "1", "]"}]}], "-", 
  FractionBox[
   RowBox[{"CupCap", " ", 
    SuperscriptBox["v", "18"], " ", 
    RowBox[{"brace", "[", "6", "]"}], " ", 
    RowBox[{"bracket", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Lambda]"}], "]"}], " ", 
    RowBox[{"bracket", "[", "\[Lambda]", "]"}]}], 
   RowBox[{"brace", "[", "2", "]"}]]}]], "Output",
 CellChangeTimes->{
  3.5934796667416*^9, {3.593479760537818*^9, 3.593479762682754*^9}, {
   3.5934798199124947`*^9, 3.593479844780282*^9}, 3.593479999607553*^9, 
   3.593480055233981*^9, 3.5934991384978743`*^9, 3.5935017272633877`*^9, 
   3.593503314988676*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bracket", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a_Integer:", "1"}], ")"}], " ", "\[Lambda]"}], "+", 
    RowBox[{"(", 
     RowBox[{"b_Integer:", "0"}], ")"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["w", "a"], 
    SuperscriptBox["v", "b"]}], "-", 
   RowBox[{
    SuperscriptBox["w", 
     RowBox[{"-", "a"}]], 
    SuperscriptBox["v", 
     RowBox[{"-", "b"}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"brace", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a_Integer:", "1"}], ")"}], " ", "\[Lambda]"}], "+", 
    RowBox[{"(", 
     RowBox[{"b_Integer:", "0"}], ")"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["w", "a"], 
    SuperscriptBox["v", "b"]}], "+", 
   RowBox[{
    SuperscriptBox["w", 
     RowBox[{"-", "a"}]], 
    SuperscriptBox["v", 
     RowBox[{"-", "b"}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bracket", "[", 
   RowBox[{"(", 
    RowBox[{"b_Integer:", "0"}], ")"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["v", "b"], "-", 
   SuperscriptBox["v", 
    RowBox[{"-", "b"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"brace", "[", 
   RowBox[{"(", 
    RowBox[{"b_Integer:", "0"}], ")"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["v", "b"], "+", 
   SuperscriptBox["v", 
    RowBox[{"-", "b"}]]}]}]}], "Input",
 CellChangeTimes->{{3.593479676932125*^9, 3.5934798427175426`*^9}}],

Cell[BoxData[{
 RowBox[{"CupCap", "/:", 
  RowBox[{
   SuperscriptBox["Twist", "k_."], " ", "CupCap"}], ":=", 
  RowBox[{
   SuperscriptBox[
    SuperscriptBox["v", "12"], "k"], "CupCap"}]}], "\[IndentingNewLine]", 
 RowBox[{"Iweb", "/:", 
  RowBox[{
   SuperscriptBox["Twist", "k_."], " ", "Iweb"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", 
      SuperscriptBox["v", "6"]}], ")"}], "k"], "Iweb"}]}]}], "Input",
 CellChangeTimes->{{3.5934799166481533`*^9, 3.593479958841557*^9}, {
  3.5934800059717207`*^9, 3.593480024601*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"id1", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Expand", "[", 
     RowBox[{"threeTwistIdentity", " ", 
      SuperscriptBox["Twist", 
       RowBox[{"-", "1"}]]}], "]"}], ",", 
    RowBox[{"Twist", "|", "CupCap", "|", "Iweb"}], ",", "Together"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.593479850356036*^9, 3.593479899102717*^9}, {
  3.593480034475155*^9, 3.593480117828678*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["Twist", "2"], "v"], "+", 
  FractionBox["v", "Twist"], "+", 
  RowBox[{"Iweb", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["v", "2"], "-", 
     SuperscriptBox["v", "4"]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"Twist", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["v", "2"]}], "+", 
      RowBox[{"v", " ", 
       SuperscriptBox["w", "2"]}], "-", 
      SuperscriptBox["w", "4"]}], ")"}]}], 
   RowBox[{"v", " ", 
    SuperscriptBox["w", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["v", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["v", "2"], " ", 
     SuperscriptBox["w", "2"]}], "-", 
    SuperscriptBox["w", "4"]}], 
   RowBox[{"v", " ", 
    SuperscriptBox["w", "2"]}]], "+", 
  FractionBox[
   RowBox[{"CupCap", " ", "v", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["v", "2"]}], "+", 
      SuperscriptBox["v", "6"], "-", 
      SuperscriptBox["v", "10"], "+", 
      SuperscriptBox["w", "2"], "+", 
      RowBox[{
       SuperscriptBox["v", "2"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "6"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "10"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      SuperscriptBox["w", "4"], "+", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "4"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "4"]}]}], ")"}]}], 
   SuperscriptBox["w", "2"]]}]], "Output",
 CellChangeTimes->{{3.5934798827494793`*^9, 3.59347990000522*^9}, {
   3.593480028314631*^9, 3.5934801239822407`*^9}, 3.5934991464014997`*^9, 
   3.593501728315599*^9, 3.593503316994007*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"id2", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Expand", "[", 
     RowBox[{"threeTwistIdentity", " ", 
      SuperscriptBox["Twist", 
       RowBox[{"-", "2"}]]}], "]"}], ",", 
    RowBox[{"Twist", "|", "CupCap", "|", "Iweb"}], ",", "Together"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5934800871995277`*^9, 3.59348012098567*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["Twist", "v"], "+", 
  FractionBox["v", 
   SuperscriptBox["Twist", "2"]], "+", 
  FractionBox[
   RowBox[{"Iweb", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["v", "2"]}], ")"}]}], 
   SuperscriptBox["v", "4"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["v", "2"]}], "+", 
    RowBox[{"v", " ", 
     SuperscriptBox["w", "2"]}], "-", 
    SuperscriptBox["w", "4"]}], 
   RowBox[{"v", " ", 
    SuperscriptBox["w", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["v", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["v", "2"], " ", 
     SuperscriptBox["w", "2"]}], "-", 
    SuperscriptBox["w", "4"]}], 
   RowBox[{"Twist", " ", "v", " ", 
    SuperscriptBox["w", "2"]}]], "+", 
  FractionBox[
   RowBox[{"CupCap", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["v", "2"]}], "+", 
      SuperscriptBox["v", "6"], "-", 
      SuperscriptBox["v", "10"], "+", 
      SuperscriptBox["w", "2"], "+", 
      RowBox[{
       SuperscriptBox["v", "2"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "6"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "10"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      SuperscriptBox["w", "4"], "+", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "4"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "4"]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["v", "11"], " ", 
    SuperscriptBox["w", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.593480087868814*^9, 3.593480122356924*^9}, 
   3.593499147404332*^9, 3.5935017290008707`*^9, 3.593503317678781*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tangleIdentity", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     FractionBox["id1", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"id1", ",", "Iweb"}], "]"}]], "-", 
     FractionBox["id2", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"id2", ",", "Iweb"}], "]"}]]}], ",", 
    RowBox[{"Twist", "|", "CupCap"}], ",", "Together"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.593480126302511*^9, 3.593480171100874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["Twist", "2"], 
    RowBox[{
     SuperscriptBox["v", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["v", "2"]}], ")"}]}]]}], "-", 
  FractionBox[
   SuperscriptBox["v", "5"], 
   RowBox[{
    SuperscriptBox["Twist", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["v", "2"]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"Twist", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["v", "2"], "-", 
      RowBox[{"v", " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "6"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      SuperscriptBox["w", "4"]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["v", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["v", "2"]}], ")"}], " ", 
    SuperscriptBox["w", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["v", "6"], "-", 
    SuperscriptBox["w", "2"], "-", 
    RowBox[{
     SuperscriptBox["v", "6"], " ", 
     SuperscriptBox["w", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["v", "4"], " ", 
     SuperscriptBox["w", "4"]}]}], 
   RowBox[{"Twist", " ", "v", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["v", "2"]}], ")"}], " ", 
    SuperscriptBox["w", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["v", "2"], "+", 
    SuperscriptBox["v", "8"], "-", 
    RowBox[{
     SuperscriptBox["v", "2"], " ", 
     SuperscriptBox["w", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["v", "7"], " ", 
     SuperscriptBox["w", "2"]}], "+", 
    SuperscriptBox["w", "4"], "+", 
    RowBox[{
     SuperscriptBox["v", "6"], " ", 
     SuperscriptBox["w", "4"]}]}], 
   RowBox[{
    SuperscriptBox["v", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["v", "2"]}], ")"}], " ", 
    SuperscriptBox["w", "2"]}]], "-", 
  FractionBox[
   RowBox[{"CupCap", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["v", "6"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["v", "2"]}], "+", 
      SuperscriptBox["v", "6"], "-", 
      SuperscriptBox["v", "10"], "+", 
      SuperscriptBox["w", "2"], "+", 
      RowBox[{
       SuperscriptBox["v", "2"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "6"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "10"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      SuperscriptBox["w", "4"], "+", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "4"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "4"]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["v", "7"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["v", "2"]}], ")"}], " ", 
    SuperscriptBox["w", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.593480132387*^9, 3.593480171757265*^9}, 
   3.5934991484245253`*^9, 3.5935017294864902`*^9, 3.5935033184320173`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tangleIdentity", "/", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"tangleIdentity", ",", 
        SuperscriptBox["Twist", "2"]}], "]"}]}], "-", 
     SuperscriptBox["Twist", "2"]}], ",", 
    RowBox[{"Twist", "|", "CupCap"}], ",", "Together"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.593480751938746*^9, 3.593480788294155*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["v", "8"], 
    SuperscriptBox["Twist", "2"]]}], "-", 
  FractionBox[
   RowBox[{"Twist", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["v", "2"]}], "+", 
      RowBox[{"v", " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "6"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      SuperscriptBox["w", "4"]}], ")"}]}], 
   SuperscriptBox["w", "2"]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["v", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["v", "6"]}], "+", 
      SuperscriptBox["w", "2"], "+", 
      RowBox[{
       SuperscriptBox["v", "6"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "4"]}]}], ")"}]}], 
   RowBox[{"Twist", " ", 
    SuperscriptBox["w", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["v", "2"]}], "-", 
    SuperscriptBox["v", "8"], "+", 
    RowBox[{
     SuperscriptBox["v", "2"], " ", 
     SuperscriptBox["w", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["v", "7"], " ", 
     SuperscriptBox["w", "2"]}], "-", 
    SuperscriptBox["w", "4"], "-", 
    RowBox[{
     SuperscriptBox["v", "6"], " ", 
     SuperscriptBox["w", "4"]}]}], 
   SuperscriptBox["w", "2"]], "-", 
  FractionBox[
   RowBox[{"CupCap", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["v", "6"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["v", "2"]}], "+", 
      SuperscriptBox["v", "6"], "-", 
      SuperscriptBox["v", "10"], "+", 
      SuperscriptBox["w", "2"], "+", 
      RowBox[{
       SuperscriptBox["v", "2"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "6"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "10"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      SuperscriptBox["w", "4"], "+", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "4"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "4"]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["v", "4"], " ", 
    SuperscriptBox["w", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.593480774607397*^9, 3.593480788688959*^9}, 
   3.593499149946374*^9, 3.593501730086735*^9, 3.593503319299616*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tangleIdentity", "/", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"tangleIdentity", ",", 
        SuperscriptBox["Twist", 
         RowBox[{"-", "2"}]]}], "]"}]}], "-", 
     SuperscriptBox["Twist", 
      RowBox[{"-", "2"}]]}], ",", 
    RowBox[{"Twist", "|", "CupCap"}], ",", "Together"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5935004006505547`*^9, 3.5935004028145657`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["Twist", "2"], 
    SuperscriptBox["v", "8"]]}], "-", 
  FractionBox[
   RowBox[{"Twist", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["v", "2"]}], "+", 
      RowBox[{"v", " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "6"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      SuperscriptBox["w", "4"]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["v", "8"], " ", 
    SuperscriptBox["w", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["v", "6"]}], "+", 
    SuperscriptBox["w", "2"], "+", 
    RowBox[{
     SuperscriptBox["v", "6"], " ", 
     SuperscriptBox["w", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["v", "4"], " ", 
     SuperscriptBox["w", "4"]}]}], 
   RowBox[{"Twist", " ", 
    SuperscriptBox["v", "6"], " ", 
    SuperscriptBox["w", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["v", "2"]}], "-", 
    SuperscriptBox["v", "8"], "+", 
    RowBox[{
     SuperscriptBox["v", "2"], " ", 
     SuperscriptBox["w", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["v", "7"], " ", 
     SuperscriptBox["w", "2"]}], "-", 
    SuperscriptBox["w", "4"], "-", 
    RowBox[{
     SuperscriptBox["v", "6"], " ", 
     SuperscriptBox["w", "4"]}]}], 
   RowBox[{
    SuperscriptBox["v", "8"], " ", 
    SuperscriptBox["w", "2"]}]], "-", 
  FractionBox[
   RowBox[{"CupCap", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["v", "6"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["v", "2"]}], "+", 
      SuperscriptBox["v", "6"], "-", 
      SuperscriptBox["v", "10"], "+", 
      SuperscriptBox["w", "2"], "+", 
      RowBox[{
       SuperscriptBox["v", "2"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "6"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["v", "10"], " ", 
       SuperscriptBox["w", "2"]}], "-", 
      SuperscriptBox["w", "4"], "+", 
      RowBox[{
       SuperscriptBox["v", "4"], " ", 
       SuperscriptBox["w", "4"]}], "-", 
      RowBox[{
       SuperscriptBox["v", "8"], " ", 
       SuperscriptBox["w", "4"]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["v", "12"], " ", 
    SuperscriptBox["w", "2"]}]]}]], "Output",
 CellChangeTimes->{3.593500403731904*^9, 3.593501730789547*^9, 
  3.593503320151539*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"claspRule", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NegativeClasp", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", 
        RowBox[{"{", 
         RowBox[{"e_", ",", "f_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"uX", "[", 
           RowBox[{"d", ",", "a", ",", "e", ",", "f"}], "]"}], 
          RowBox[{"uX", "[", 
           RowBox[{"f", ",", "e", ",", "b", ",", "c"}], "]"}]}], ",", 
         RowBox[{"uX", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
         RowBox[{"uX", "[", 
          RowBox[{"d", ",", "a", ",", "b", ",", "c"}], "]"}], ",", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"a", ",", "b"}], "]"}], 
          RowBox[{"P", "[", 
           RowBox[{"d", ",", "c"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"a", ",", "d"}], "]"}], 
          RowBox[{"P", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}]}], "}"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["v", "8"]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["v", "2"]}], "+", 
             RowBox[{"v", " ", 
              SuperscriptBox["w", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["v", "6"], " ", 
              SuperscriptBox["w", "2"]}], "-", 
             SuperscriptBox["w", "4"]}], ")"}], 
           SuperscriptBox["w", "2"]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["v", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["v", "6"]}], "+", 
              SuperscriptBox["w", "2"], "+", 
              RowBox[{
               SuperscriptBox["v", "6"], " ", 
               SuperscriptBox["w", "2"]}], "-", 
              RowBox[{
               SuperscriptBox["v", "4"], " ", 
               SuperscriptBox["w", "4"]}]}], ")"}]}], 
           SuperscriptBox["w", "2"]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["v", "2"]}], "-", 
            SuperscriptBox["v", "8"], "+", 
            RowBox[{
             SuperscriptBox["v", "2"], " ", 
             SuperscriptBox["w", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["v", "7"], " ", 
             SuperscriptBox["w", "2"]}], "-", 
            SuperscriptBox["w", "4"], "-", 
            RowBox[{
             SuperscriptBox["v", "6"], " ", 
             SuperscriptBox["w", "4"]}]}], 
           SuperscriptBox["w", "2"]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{" ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["v", "6"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["v", "2"]}], "+", 
               SuperscriptBox["v", "6"], "-", 
               SuperscriptBox["v", "10"], "+", 
               SuperscriptBox["w", "2"], "+", 
               RowBox[{
                SuperscriptBox["v", "2"], " ", 
                SuperscriptBox["w", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["v", "4"], " ", 
                SuperscriptBox["w", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["v", "6"], " ", 
                SuperscriptBox["w", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["v", "8"], " ", 
                SuperscriptBox["w", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["v", "10"], " ", 
                SuperscriptBox["w", "2"]}], "-", 
               SuperscriptBox["w", "4"], "+", 
               RowBox[{
                SuperscriptBox["v", "4"], " ", 
                SuperscriptBox["w", "4"]}], "-", 
               RowBox[{
                SuperscriptBox["v", "8"], " ", 
                SuperscriptBox["w", "4"]}]}], ")"}]}]}], 
           RowBox[{
            SuperscriptBox["v", "4"], " ", 
            SuperscriptBox["w", "2"]}]]}]}], "}"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PositiveClasp", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", 
        RowBox[{"{", 
         RowBox[{"e_", ",", "f_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"uX", "[", 
           RowBox[{"b", ",", "e", ",", "f", ",", "a"}], "]"}], 
          RowBox[{"uX", "[", 
           RowBox[{"e", ",", "c", ",", "d", ",", "f"}], "]"}]}], ",", 
         RowBox[{"uX", "[", 
          RowBox[{"b", ",", "c", ",", "d", ",", "a"}], "]"}], ",", 
         RowBox[{"uX", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"a", ",", "d"}], "]"}], 
          RowBox[{"P", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"a", ",", "b"}], "]"}], 
          RowBox[{"P", "[", 
           RowBox[{"d", ",", "c"}], "]"}]}]}], "}"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SuperscriptBox["v", "8"]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["v", "2"]}], "+", 
             RowBox[{"v", " ", 
              SuperscriptBox["w", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["v", "6"], " ", 
              SuperscriptBox["w", "2"]}], "-", 
             SuperscriptBox["w", "4"]}], ")"}], 
           RowBox[{
            SuperscriptBox["v", "8"], " ", 
            SuperscriptBox["w", "2"]}]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["v", "6"]}], "+", 
            SuperscriptBox["w", "2"], "+", 
            RowBox[{
             SuperscriptBox["v", "6"], " ", 
             SuperscriptBox["w", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["v", "4"], " ", 
             SuperscriptBox["w", "4"]}]}], 
           RowBox[{
            SuperscriptBox["v", "6"], " ", 
            SuperscriptBox["w", "2"]}]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["v", "2"]}], "-", 
            SuperscriptBox["v", "8"], "+", 
            RowBox[{
             SuperscriptBox["v", "2"], " ", 
             SuperscriptBox["w", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["v", "7"], " ", 
             SuperscriptBox["w", "2"]}], "-", 
            SuperscriptBox["w", "4"], "-", 
            RowBox[{
             SuperscriptBox["v", "6"], " ", 
             SuperscriptBox["w", "4"]}]}], 
           RowBox[{
            SuperscriptBox["v", "8"], " ", 
            SuperscriptBox["w", "2"]}]]}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["v", "6"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["v", "2"]}], "+", 
              SuperscriptBox["v", "6"], "-", 
              SuperscriptBox["v", "10"], "+", 
              SuperscriptBox["w", "2"], "+", 
              RowBox[{
               SuperscriptBox["v", "2"], " ", 
               SuperscriptBox["w", "2"]}], "-", 
              RowBox[{
               SuperscriptBox["v", "4"], " ", 
               SuperscriptBox["w", "2"]}], "-", 
              RowBox[{
               SuperscriptBox["v", "6"], " ", 
               SuperscriptBox["w", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["v", "8"], " ", 
               SuperscriptBox["w", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["v", "10"], " ", 
               SuperscriptBox["w", "2"]}], "-", 
              SuperscriptBox["w", "4"], "+", 
              RowBox[{
               SuperscriptBox["v", "4"], " ", 
               SuperscriptBox["w", "4"]}], "-", 
              RowBox[{
               SuperscriptBox["v", "8"], " ", 
               SuperscriptBox["w", "4"]}]}], ")"}]}], 
           RowBox[{
            SuperscriptBox["v", "12"], " ", 
            SuperscriptBox["w", "2"]}]]}]}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.593480810659747*^9, 3.593480816794957*^9}, {
  3.593481150478983*^9, 3.593481161099848*^9}, {3.5934812019781027`*^9, 
  3.593481331635708*^9}, {3.593482431310545*^9, 3.593482435429504*^9}, {
  3.5934994074619923`*^9, 3.593499423505166*^9}, {3.593500336445484*^9, 
  3.593500353328541*^9}, {3.593500676851664*^9, 3.593500738446142*^9}, {
  3.593500851111409*^9, 3.593500856833673*^9}, {3.5935008959582367`*^9, 
  3.593500912963173*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"undoClaspRule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"NegativeClasp", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", 
        RowBox[{"{", 
         RowBox[{"e_", ",", "f_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"uX", "[", 
        RowBox[{"a", ",", "e", ",", "f", ",", "d"}], "]"}], 
       RowBox[{"uX", "[", 
        RowBox[{"e", ",", "b", ",", "c", ",", "f"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"PositiveClasp", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", 
        RowBox[{"{", 
         RowBox[{"e_", ",", "f_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"uX", "[", 
        RowBox[{"a", ",", "b", ",", "e", ",", "f"}], "]"}], 
       RowBox[{"uX", "[", 
        RowBox[{"f", ",", "e", ",", "c", ",", "d"}], "]"}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.593481388435421*^9, 3.593481418886998*^9}, {
  3.593482440808341*^9, 3.593482455790852*^9}, {3.593484328336111*^9, 
  3.593484340827497*^9}, {3.593500928037773*^9, 3.5935009527001457`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uX", "[", 
   RowBox[{"a_", ",", "a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["v", 
    RowBox[{"-", "12"}]], 
   RowBox[{"P", "[", 
    RowBox[{"b", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uX", "[", 
   RowBox[{"a_", ",", "b_", ",", "b_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["v", "12"], 
   RowBox[{"P", "[", 
    RowBox[{"a", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uX", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["v", 
    RowBox[{"-", "12"}]], 
   RowBox[{"P", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uX", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_", ",", "a_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["v", "12"], 
   RowBox[{"P", "[", 
    RowBox[{"b", ",", "c"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.5934825249042377`*^9, 3.5934825895860558`*^9}, {
  3.593502417154942*^9, 3.593502418299604*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uX", "/:", 
     RowBox[{
      RowBox[{"RotateLeft", "[", 
       RowBox[{
        RowBox[{"uX", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ",", "k1"}], 
       "]"}], 
      RowBox[{"RotateLeft", "[", 
       RowBox[{
        RowBox[{"uX", "[", 
         RowBox[{"c_", ",", "b_", ",", "e_", ",", "f_"}], "]"}], ",", "k2"}], 
       "]"}]}], ":=", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"a", ",", "e"}], "]"}], 
      RowBox[{"P", "[", 
       RowBox[{"d", ",", "f"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k1", ",", "0", ",", "2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k2", ",", "0", ",", "2", ",", "2"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.593502865486545*^9, 3.5935028680114517`*^9}, {
  3.593502899944044*^9, 3.59350291083072*^9}, {3.593502970337805*^9, 
  3.593503014613524*^9}}],

Cell[BoxData[{
 RowBox[{"P", "/:", 
  RowBox[{
   RowBox[{"uX", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{"a_", ",", "e_"}], "]"}]}], ":=", 
  RowBox[{"uX", "[", 
   RowBox[{"e", ",", "b", ",", "c", ",", "d"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"P", "/:", 
  RowBox[{
   RowBox[{"uX", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{"b_", ",", "e_"}], "]"}]}], ":=", 
  RowBox[{"uX", "[", 
   RowBox[{"a", ",", "e", ",", "c", ",", "d"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"P", "/:", 
  RowBox[{
   RowBox[{"uX", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{"c_", ",", "e_"}], "]"}]}], ":=", 
  RowBox[{"uX", "[", 
   RowBox[{"a", ",", "b", ",", "e", ",", "d"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"P", "/:", 
  RowBox[{
   RowBox[{"uX", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{"d_", ",", "e_"}], "]"}]}], ":=", 
  RowBox[{"uX", "[", 
   RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5934815701332493`*^9, 3.593481614973049*^9}, {
  3.5934824805202217`*^9, 3.593482485741653*^9}}],

Cell[BoxData[
 RowBox[{"P", "/:", 
  SuperscriptBox[
   RowBox[{"P", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "2"], ":=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"brace", "[", "2", "]"}], 
     RowBox[{"bracket", "[", 
      RowBox[{"\[Lambda]", "+", "5"}], "]"}], 
     RowBox[{"bracket", "[", 
      RowBox[{"\[Lambda]", "-", "6"}], "]"}]}], 
    RowBox[{
     RowBox[{"bracket", "[", "\[Lambda]", "]"}], 
     RowBox[{"bracket", "[", 
      RowBox[{"\[Lambda]", "-", "1"}], "]"}]}]]}]}]], "Input",
 CellChangeTimes->{{3.593502194176346*^9, 3.593502202443836*^9}, {
  3.593502236325198*^9, 3.593502263177434*^9}}],

Cell[BoxData[
 RowBox[{"P", "/:", 
  RowBox[{"P", "[", 
   RowBox[{"a_", ",", "a_"}], "]"}], ":=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"brace", "[", "2", "]"}], 
     RowBox[{"bracket", "[", 
      RowBox[{"\[Lambda]", "+", "5"}], "]"}], 
     RowBox[{"bracket", "[", 
      RowBox[{"\[Lambda]", "-", "6"}], "]"}]}], 
    RowBox[{
     RowBox[{"bracket", "[", "\[Lambda]", "]"}], 
     RowBox[{"bracket", "[", 
      RowBox[{"\[Lambda]", "-", "1"}], "]"}]}]]}]}]], "Input",
 CellChangeTimes->{{3.5935031778484087`*^9, 3.5935031796969233`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DrawPD", "[", 
  RowBox[{"Knot", "[", 
   RowBox[{"8", ",", "19"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.593480187331044*^9, 3.593480206252138*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"KnotTheory", "::", "credits"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\\"DrawPD was written by Emily Redelmeier \
at the University of Toronto in the summers of 2003 and \
2004.\\\"\\)\[NoBreak]\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.593501734332016*^9, 3.5935033267214003`*^9}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.3956292187217095, -0.040097409995249744`}, 
     0.4088525004170025, {1.5838497787743793`, 2.3684209654713912`}], 
    CircleBox[{-0.3956292187217095, -0.040097409995249744`}, 
     0.4088525004170025, {0.9946384636898509, 1.4963626762305402`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.08628600095346134, 0.2525900075855073}, 
     0.48348456859880873`, {2.1283615566151863`, 3.341097823982609}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.26026216882599856`, -0.3106645914209916}, 
     0.311760182202669, {-3.866782105556889, -3.534813949119509}], 
    CircleBox[{-0.26026216882599856`, -0.3106645914209916}, 
     0.311760182202669, {-3.420080501196277, -2.456615413278376}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.5352521278518095, 0.02376062564227266}, 
     0.23248333041041735`, {-2.812612618646634, -1.1101079061743733`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.23800197864746173`, 0.15509304891455977`}, 
     0.8167378032044795, {-1.440169042110707, -0.9358593571889493}], 
    CircleBox[{-0.23800197864746173`, 0.15509304891455977`}, 
     0.8167378032044795, {-0.8920640039079502, -0.623726761873641}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.46897770162226227`, -0.09925790510156773}, 
     0.4442869118762334, {-2.699325688785079, -1.3558303205334916`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.21266184496149854`, 0.041899933854318366`}, 
     0.2373339034438274, {0.5363412434314451, 0.9380686949780316}], 
    CircleBox[{-0.21266184496149854`, 0.041899933854318366`}, 
     0.2373339034438274, {0.13037550597326242`, 0.38562817584920095`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.30311757650948534`, -0.1491978195109842}, 
     0.42421204968052106`, {2.074701488637647, 2.544053186296547}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.3849836018733142, 0.06810207199237626}, 
     0.44612271292133887`, {-3.085677592208632, -2.9594000664623654`}], 
    CircleBox[{0.3849836018733142, 0.06810207199237626}, 
     0.44612271292133887`, {-2.8792218563123835`, -2.6339663190940157`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.16000062427893702`, 0.15381541855021003`}, 
     0.21434482647276043`, {-1.5577894450489012`, -0.6656121276635529}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.482187431787361, -0.0482677321841708}, 0.4370020454068731, {
     0.9599044639560004, 1.5820981820044506`}], 
    CircleBox[{0.482187431787361, -0.0482677321841708}, 0.4370020454068731, {
     1.6639497911793784`, 2.2175998601821876`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.19107128295653508`, 0.03670663332651647}, 
     0.7393129615453494, {0.19534134939827516`, 1.0074220483136012`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.15954670572523777`, -0.2969587162710179}, 
     0.5608897484740817, {-0.12424354920321647`, 0.30599556604510153`}], 
    CircleBox[{0.15954670572523777`, -0.2969587162710179}, 
     0.5608897484740817, {0.3697680288626141, 0.6944191065151436}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.2906276520462967, 0.24267417096780294`}, 
     0.5325283700941942, {-1.1075800290132065`, -0.2503567785751431}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.6949346821585527, -0.010166538844065674`}, 
     0.33291545818101415`, {-0.08867776130201493, 0.17226372429620518`}], 
    CircleBox[{-0.6949346821585527, -0.010166538844065674`}, 
     0.33291545818101415`, {-0.38659842158965574`, -0.1961204160370159}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.3057034665391431, -0.5755451412260881}, 
     0.5215581532086666, {1.4743704924243743`, 1.8366659415465476`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.016244574524477803`, 0.3649145639058404}, 
     0.35111158280198385`, {1.0074220483136012`, 2.1283615566151863`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-4.410273535680879, -0.6565915075701942}, 4.104070193362955, {
     0.17226372429620676`, 0.1995051703928175}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.4737199722413335, -0.10021953479223232`}, 
     0.09407348121088442, {-1.1101079061743733`, -0.38659842158965574`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.48029443070134903`, 0.042522393951013746`}, 
     0.2905552894453304, {2.3684209654713912`, 3.4705726885329526`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-1.3501475043603688`, -1.5092858428445086`}, 
     2.160885550572343, {0.9380686949780334, 0.9946384636898524}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.04539229593253148, 0.06383219350860243}, 
     0.06863261107801015, {-0.665612127663553, 0.13037550597326236`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.16890935470084845`, 0.8387011736647214}, 
     0.8992885198056537, {-1.6672221611654177`, -1.5577894450488998`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.4152386274325053, -0.17331029028094042`}, 
     0.10467588351277275`, {1.8366659415465476`, 2.416403201622697}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.18490096348231627`, -0.24910000808837096`}, 
     0.40907158539762783`, {-2.456615413278376, -1.440169042110707}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.6554753730091105, -0.4878087648931907}, 
     0.28400036735223255`, {2.0340126245765866`, 2.517865891716152}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.6258846781345533, 0.15694157500943773`}, 
     0.18648306735002707`, {-0.2503567785751434, 0.9599044639560004}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-0.3876098239134059, 1.103517893120477}, 
     1.0063126786512595`, {-1.0668911649521458`, -0.9239927934076051}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.014296960030038774`, 0.047353477699670035`}, 
     0.0748558404344874, {2.544053186296547, 3.1975077149709543`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{-2.119873010915624, -1.3252156490189426`}, 
     2.4201712221656835`, {0.4422669648047137, 0.5076263344957774}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.5220276525043455, -0.34222780717593315`}, 
     0.19559298231095806`, {-1.3558303205334914`, -0.12424354920321658`}]}, 
   {RGBColor[0, 0, 0], 
    CircleBox[{0.7943274925901074, 0.23168206489832066`}, 
     0.265189983082208, {-2.946251304191518, -2.4471735470746494`}]}, 
   {RGBColor[0, 0, 0]}},
  AspectRatio->1]], "Output",
 CellChangeTimes->{{3.593480198946123*^9, 3.593480211565209*^9}, 
   3.5934994473535213`*^9, 3.5935009640281277`*^9, 3.593501739559738*^9, 
   3.593503338307777*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindClasps", "[", 
   RowBox[{"diagram", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"Times", "[", "___uX", "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"XX", ",", "claspDiagram", ",", "clasps"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XX", "/:", 
      RowBox[{
       RowBox[{"XX", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], 
       RowBox[{"XX", "[", 
        RowBox[{"b_", ",", "e_", ",", "f_", ",", "c_"}], "]"}]}], ":=", 
      RowBox[{"NegativeClasp", "[", 
       RowBox[{"a", ",", "e", ",", "f", ",", "d", ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "c"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"XX", "/:", 
      RowBox[{
       RowBox[{"XX", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], 
       RowBox[{"XX", "[", 
        RowBox[{"d_", ",", "c_", ",", "e_", ",", "f_"}], "]"}]}], ":=", 
      RowBox[{"PositiveClasp", "[", 
       RowBox[{"a", ",", "b", ",", "e", ",", "f", ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "d"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"XX", "/:", 
      RowBox[{
       RowBox[{"XX", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], " ", 
       RowBox[{"XX", "[", 
        RowBox[{"b_", ",", "a_", ",", "e_", ",", "f_"}], "]"}]}], ":=", 
      RowBox[{"PositiveClasp", "[", 
       RowBox[{"c", ",", "d", ",", "e", ",", "f", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"claspDiagram", "=", 
      RowBox[{"diagram", "/.", 
       RowBox[{"uX", "\[Rule]", "XX"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"clasps", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"claspDiagram", ",", 
        RowBox[{"_NegativeClasp", "|", "_PositiveClasp"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"claspDiagram", ",", "#"}], "]"}], "/.", 
           "undoClaspRule"}], "/.", 
          RowBox[{"XX", "\[Rule]", "uX"}]}]}], "}"}], "&"}], "/@", 
      "clasps"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.593482897136989*^9, 3.5934829817918587`*^9}, {
  3.59348302090914*^9, 3.5934830220762568`*^9}, {3.5934833970822077`*^9, 
  3.593483499775188*^9}, {3.5934835340315657`*^9, 3.593483570723874*^9}, {
  3.593484174966146*^9, 3.593484207167193*^9}, {3.5935019052701902`*^9, 
  3.593501969994336*^9}, {3.593503061885029*^9, 3.5935030701874123`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uX", "[", 
   RowBox[{"2", ",", "7", ",", "3", ",", "8"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"6", ",", "3", ",", "7", ",", "4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5935033924713*^9, 3.5935033940394897`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pd", "=", 
  RowBox[{
   RowBox[{"Times", "@@", 
    RowBox[{"PD", "[", 
     RowBox[{"Knot", "[", 
      RowBox[{"8", ",", "19"}], "]"}], "]"}]}], "/.", 
   RowBox[{"X", "\[Rule]", "uX"}]}]}]], "Input",
 CellChangeTimes->{{3.5934836330790567`*^9, 3.593483633415763*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uX", "[", 
   RowBox[{"2", ",", "8", ",", "3", ",", "7"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"4", ",", "2", ",", "5", ",", "1"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"5", ",", "13", ",", "6", ",", "12"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"8", ",", "4", ",", "9", ",", "3"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"9", ",", "15", ",", "10", ",", "14"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"11", ",", "1", ",", "12", ",", "16"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"13", ",", "7", ",", "14", ",", "6"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"15", ",", "11", ",", "16", ",", "10"}], "]"}]}]], "Output",
 CellChangeTimes->{3.593483634020267*^9, 3.593499451675655*^9, 
  3.5935009643241158`*^9, 3.593501739765126*^9, 3.5935033385199947`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindClasps", "[", "pd", "]"}]], "Input",
 CellChangeTimes->{{3.5934835014660807`*^9, 3.593483514301661*^9}, {
   3.593483631609435*^9, 3.593483636557342*^9}, 3.593484210648121*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NegativeClasp", "[", 
      RowBox[{"2", ",", "4", ",", "9", ",", "7", ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"uX", "[", 
       RowBox[{"4", ",", "2", ",", "5", ",", "1"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"5", ",", "13", ",", "6", ",", "12"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"9", ",", "15", ",", "10", ",", "14"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"11", ",", "1", ",", "12", ",", "16"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"13", ",", "7", ",", "14", ",", "6"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"15", ",", "11", ",", "16", ",", "10"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NegativeClasp", "[", 
      RowBox[{"5", ",", "7", ",", "14", ",", "12", ",", 
       RowBox[{"{", 
        RowBox[{"13", ",", "6"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"uX", "[", 
       RowBox[{"2", ",", "8", ",", "3", ",", "7"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"4", ",", "2", ",", "5", ",", "1"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"8", ",", "4", ",", "9", ",", "3"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"9", ",", "15", ",", "10", ",", "14"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"11", ",", "1", ",", "12", ",", "16"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"15", ",", "11", ",", "16", ",", "10"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NegativeClasp", "[", 
      RowBox[{"9", ",", "11", ",", "16", ",", "14", ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "10"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"uX", "[", 
       RowBox[{"2", ",", "8", ",", "3", ",", "7"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"4", ",", "2", ",", "5", ",", "1"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"5", ",", "13", ",", "6", ",", "12"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"8", ",", "4", ",", "9", ",", "3"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"11", ",", "1", ",", "12", ",", "16"}], "]"}], " ", 
      RowBox[{"uX", "[", 
       RowBox[{"13", ",", "7", ",", "14", ",", "6"}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.593483514952734*^9, 3.593483540804837*^9}, 
   3.593483571722905*^9, 3.5934836367956877`*^9, {3.593484211062895*^9, 
   3.5934842216045218`*^9}, 3.593499455036091*^9, 3.5935009668809223`*^9, 
   3.5935017399158983`*^9, 3.593503338670368*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "QuantumExceptionalInvariant", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuantumExceptionalInvariant", "[", 
   RowBox[{"diagram", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"Times", "[", "___uX", "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"QuantumExceptionalInvariant", "[", "diagram", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"clasps", "=", 
       RowBox[{"FindClasps", "[", "diagram", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"clasps", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<No clasp in \>\"", ",", "diagram"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"CollectDiagrams", "[", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.",
                "claspRule"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ")"}]}], "]"}], ",", "QuantumExceptionalInvariant"}], "]"}], 
         "&"}], "@", 
        RowBox[{
        "clasps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.593483192584715*^9, 3.593483264844748*^9}, {
   3.593483599156476*^9, 3.593483674608508*^9}, {3.593483822130843*^9, 
   3.5934838264279537`*^9}, {3.5934838890150414`*^9, 3.593483892723216*^9}, {
   3.593484033863171*^9, 3.593484083721142*^9}, 3.593484216800414*^9, {
   3.5934994629929037`*^9, 3.5934994639635353`*^9}, {3.593501742636948*^9, 
   3.593501742820765*^9}, 3.593503187074114*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QuantumExceptionalInvariant", "[", 
   RowBox[{
    RowBox[{"uX", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], " ", 
    RowBox[{"uX", "[", 
     RowBox[{"c_", ",", "b_", ",", "a_", ",", "d_"}], "]"}]}], "]"}], ":=", 
  "Hopf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuantumExceptionalInvariant", "[", 
   RowBox[{
    RowBox[{"uX", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], " ", 
    RowBox[{"uX", "[", 
     RowBox[{"b_", ",", "a_", ",", "d_", ",", "c_"}], "]"}]}], "]"}], ":=", 
  "Hopf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuantumExceptionalInvariant", "[", 
   RowBox[{
    RowBox[{"uX", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], " ", 
    RowBox[{"uX", "[", 
     RowBox[{"d_", ",", "c_", ",", "b_", ",", "a_"}], "]"}]}], "]"}], ":=", 
  "Hopf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuantumExceptionalInvariant", "[", 
   RowBox[{
    RowBox[{"uX", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], " ", 
    RowBox[{"uX", "[", 
     RowBox[{"d_", ",", "c_", ",", "b_", ",", "a_"}], "]"}]}], "]"}], ":=", 
  "Hopf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuantumExceptionalInvariant", "[", 
   RowBox[{
    RowBox[{"uX", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], " ", 
    RowBox[{"uX", "[", 
     RowBox[{"a_", ",", "d_", ",", "c_", ",", "b_"}], "]"}]}], "]"}], ":=", 
  "Hopf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuantumExceptionalInvariant", "[", 
   RowBox[{
    RowBox[{"uX", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], " ", 
    RowBox[{"uX", "[", 
     RowBox[{"d_", ",", "c_", ",", "b_", ",", "a_"}], "]"}]}], "]"}], ":=", 
  "Hopf"}]}], "Input",
 CellChangeTimes->{{3.5934994889420147`*^9, 3.5934995796654787`*^9}, {
  3.593499655976819*^9, 3.5934996697683687`*^9}, {3.593502002162994*^9, 
  3.5935020134272213`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CollectDiagrams", "[", 
   RowBox[{"diagrams_", ",", 
    RowBox[{"f_:", 
     RowBox[{"(", 
      RowBox[{"#", "&"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"constant", ",", "arrays", ",", "Xs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xs", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"diagrams", ",", "_uX", ",", "\[Infinity]"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Xs", "===", 
        RowBox[{"{", "}"}]}], ",", "diagrams", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"arrays", "=", 
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{"diagrams", ",", "Xs"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"constant", "=", 
         RowBox[{
         "arrays", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"arrays", "=", 
         RowBox[{"Rest", "[", "arrays", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"constant", "+", 
         RowBox[{"Plus", "@@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"ArrayRules", "/@", "arrays"}], "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"i", ":", 
                RowBox[{"{", "__Integer", "}"}]}], "\[Rule]", "c_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"Times", "@@", 
                RowBox[{
                "Xs", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "]"}], 
              RowBox[{"Together", "[", "c", "]"}]}]}]}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5841718786449127`*^9, 3.584171939168981*^9}, {
  3.5841720850399103`*^9, 3.5841721267583103`*^9}, {3.5842540015562067`*^9, 
  3.58425400290131*^9}, {3.584291477851302*^9, 3.584291520201872*^9}, {
  3.584292277251841*^9, 3.584292280946431*^9}, {3.584328200539967*^9, 
  3.584328211344529*^9}, {3.5914244149893217`*^9, 3.591424432496242*^9}, {
  3.59348374842826*^9, 3.593483811205509*^9}, {3.5934839196556168`*^9, 
  3.593483931529922*^9}, {3.593483977351935*^9, 3.59348402846631*^9}, {
  3.59348410437936*^9, 3.593484108714777*^9}, {3.593499640223609*^9, 
  3.593499643698295*^9}, {3.5935020970814867`*^9, 3.593502098758896*^9}, {
  3.593502308510619*^9, 3.593502310278309*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pd", "=", 
  RowBox[{
   RowBox[{"Times", "@@", 
    RowBox[{"PD", "[", 
     RowBox[{"Knot", "[", 
      RowBox[{"4", ",", "1"}], "]"}], "]"}]}], "/.", 
   RowBox[{"X", "\[Rule]", "uX"}]}]}]], "Input",
 CellChangeTimes->{{3.5934836330790567`*^9, 3.593483633415763*^9}, {
  3.5935033465579157`*^9, 3.593503369524384*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uX", "[", 
   RowBox[{"2", ",", "7", ",", "3", ",", "8"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"4", ",", "2", ",", "5", ",", "1"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"6", ",", "3", ",", "7", ",", "4"}], "]"}], " ", 
  RowBox[{"uX", "[", 
   RowBox[{"8", ",", "6", ",", "1", ",", "5"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.593483634020267*^9, 3.593499451675655*^9, 3.5935009643241158`*^9, 
   3.593501739765126*^9, {3.5935033385199947`*^9, 3.593503370039083*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Together", "[", 
  RowBox[{"QuantumExceptionalInvariant", "[", "pd", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5934836388190193`*^9, 3.5934836393099337`*^9}, {
  3.593501752396702*^9, 3.593501753066659*^9}, {3.593503357857958*^9, 
  3.59350335916822*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"No clasp in \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"uX", "[", 
     RowBox[{"2", ",", "7", ",", "3", ",", "8"}], "]"}], " ", 
    RowBox[{"uX", "[", 
     RowBox[{"4", ",", "2", ",", "5", ",", "1"}], "]"}], " ", 
    RowBox[{"uX", "[", 
     RowBox[{"6", ",", "3", ",", "7", ",", "4"}], "]"}], " ", 
    RowBox[{"uX", "[", 
     RowBox[{"8", ",", "6", ",", "1", ",", "5"}], "]"}]}]}],
  SequenceForm[
  "No clasp in ", $CellContext`uX[2, 7, 3, 8] $CellContext`uX[
    4, 2, 5, 1] $CellContext`uX[6, 3, 7, 4] $CellContext`uX[8, 6, 1, 5]],
  Editable->False]], "Print",
 CellChangeTimes->{3.593503371443664*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.5935033497133512`*^9, 3.593503371445066*^9}}]
}, Open  ]]
},
Evaluator->"Local (2)",
WindowSize->{1167, 772},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 469, 12, 63, "Input"],
Cell[1051, 36, 263, 4, 38, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1351, 45, 180, 4, 28, "Input"],
Cell[1534, 51, 320, 8, 24, "Message"],
Cell[1857, 61, 422, 10, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2316, 76, 1142, 34, 54, "Input"],
Cell[3461, 112, 1256, 37, 54, "Output"]
}, Open  ]],
Cell[4732, 152, 1449, 51, 90, "Input"],
Cell[6184, 205, 560, 16, 57, "Input"],
Cell[CellGroupData[{
Cell[6769, 225, 425, 11, 35, "Input"],
Cell[7197, 238, 2033, 65, 98, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9267, 308, 377, 10, 35, "Input"],
Cell[9647, 320, 2016, 66, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11700, 391, 464, 12, 51, "Input"],
Cell[12167, 405, 3435, 116, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15639, 526, 431, 11, 35, "Input"],
Cell[16073, 539, 2694, 89, 98, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18804, 633, 482, 13, 35, "Input"],
Cell[19289, 648, 2691, 91, 98, "Output"]
}, Open  ]],
Cell[21995, 742, 9241, 248, 285, "Input"],
Cell[31239, 992, 1131, 28, 46, "Input"],
Cell[32373, 1022, 1064, 32, 90, "Input"],
Cell[33440, 1056, 1002, 28, 63, "Input"],
Cell[34445, 1086, 1284, 37, 80, "Input"],
Cell[35732, 1125, 637, 18, 51, "Input"],
Cell[36372, 1145, 566, 16, 51, "Input"],
Cell[CellGroupData[{
Cell[36963, 1165, 181, 4, 28, "Input"],
Cell[37147, 1171, 361, 8, 21, "Message"],
Cell[37511, 1181, 6319, 118, 375, "Output"]
}, Open  ]],
Cell[43845, 1302, 2747, 68, 149, "Input"],
Cell[46595, 1372, 261, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[46881, 1382, 295, 8, 28, "Input"],
Cell[47179, 1392, 845, 19, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48061, 1416, 204, 3, 28, "Input"],
Cell[48268, 1421, 2663, 64, 63, "Output"]
}, Open  ]],
Cell[50946, 1488, 2071, 50, 165, "Input"],
Cell[53020, 1540, 1955, 51, 114, "Input"],
Cell[54978, 1593, 2664, 63, 165, "Input"],
Cell[CellGroupData[{
Cell[57667, 1660, 345, 9, 28, "Input"],
Cell[58015, 1671, 527, 12, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58579, 1688, 283, 5, 28, "Input"],
Cell[58865, 1695, 672, 16, 22, "Print"],
Cell[59540, 1713, 103, 1, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
