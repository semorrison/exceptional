(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     83763,       2353]
NotebookOptionsPosition[     80933,       2258]
NotebookOutlinePosition[     81309,       2275]
CellTagsIndexPosition[     81266,       2272]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"RR", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "b"}], " ", 
            SuperscriptBox["Cube", "2"]}], "+", 
           RowBox[{"b", " ", 
            SuperscriptBox["Cube", "2"], " ", "d"}], "+", 
           RowBox[{
            SuperscriptBox["b", "9"], " ", 
            SuperscriptBox["d", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "5"], " ", "Cube", " ", 
            SuperscriptBox["d", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["Cube", "2"], " ", "t"}], "-", 
           RowBox[{
            SuperscriptBox["b", "4"], " ", "Cube", " ", "d", " ", "t"}], "+", 
           
           RowBox[{"5", " ", 
            SuperscriptBox["b", "3"], " ", "Cube", " ", "d", " ", 
            SuperscriptBox["t", "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["b", "7"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", "Cube", " ", "d", " ", 
            SuperscriptBox["t", "3"]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["b", "6"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "3"]}], "+", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", "Cube", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "3"]}], "-", 
           RowBox[{"2", " ", "b", " ", "Cube", " ", "d", " ", 
            SuperscriptBox["t", "4"]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["b", "5"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "4"]}], "-", 
           RowBox[{"2", " ", "b", " ", "Cube", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "4"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "5"], " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "4"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "4"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "5"]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["b", "4"], " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "5"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["b", "3"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "6"]}], "+", 
           RowBox[{
            SuperscriptBox["b", "3"], " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "6"]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "7"]}], "+", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "7"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "4"], " ", "d", " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["b", "4"], " ", 
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["b", "3"], " ", "d", " ", "t", " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["b", "2"], " ", "d", " ", 
            SuperscriptBox["t", "2"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "2"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{"b", " ", "d", " ", 
            SuperscriptBox["t", "3"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "+", 
           RowBox[{"b", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "3"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "b"}], "+", 
             RowBox[{"b", " ", "d"}], "+", "t", "-", 
             RowBox[{"d", " ", "t"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["b", "5"], " ", "d"}], "-", 
             RowBox[{"b", " ", "Cube", " ", "d"}], "-", 
             RowBox[{"Cube", " ", "t"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["b", "4"], " ", "d", " ", "t"}], "-", 
             RowBox[{"Cube", " ", "d", " ", "t"}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["b", "3"], " ", "d", " ", 
              SuperscriptBox["t", "2"]}], "+", 
             RowBox[{"2", " ", "b", " ", "d", " ", 
              SuperscriptBox["t", "4"]}], "+", 
             RowBox[{"2", " ", "b", " ", 
              SuperscriptBox["d", "2"], " ", 
              SuperscriptBox["t", "4"]}]}], ")"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", 
           SuperscriptBox["Cube", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "5"], " ", "Cube", " ", "d"}], "+", 
          RowBox[{
           SuperscriptBox["b", "9"], " ", 
           SuperscriptBox["d", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "4"], " ", "Cube", " ", "d", " ", "t"}], "+", 
          RowBox[{
           SuperscriptBox["Cube", "2"], " ", "d", " ", "t"}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "7"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "3"], " ", "Cube", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "2"], " ", "Cube", " ", "d", " ", 
           SuperscriptBox["t", "3"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "6"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "3"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "2"], " ", "Cube", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "3"]}], "-", 
          RowBox[{"2", " ", "b", " ", "Cube", " ", "d", " ", 
           SuperscriptBox["t", "4"]}], "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "5"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "4"]}], "-", 
          RowBox[{"2", " ", "b", " ", "Cube", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "4"]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["b", "4"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "5"]}], "+", 
          RowBox[{
           SuperscriptBox["b", "4"], " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "5"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "3"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "6"]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "3"], " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "6"]}], "+", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "7"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "7"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "4"], " ", "d", " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["b", "4"], " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["b", "3"], " ", "d", " ", "t", " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"], " ", "d", " ", 
           SuperscriptBox["t", "2"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "2"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "+", 
          RowBox[{"b", " ", "d", " ", 
           SuperscriptBox["t", "3"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "-", 
          RowBox[{"b", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "3"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "b"}], "+", 
            RowBox[{"b", " ", "d"}], "+", "t", "-", 
            RowBox[{"d", " ", "t"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["b", "5"], " ", "d"}], "-", 
            RowBox[{"b", " ", "Cube", " ", "d"}], "-", 
            RowBox[{"Cube", " ", "t"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["b", "4"], " ", "d", " ", "t"}], "-", 
            RowBox[{"Cube", " ", "d", " ", "t"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["b", "3"], " ", "d", " ", 
             SuperscriptBox["t", "2"]}], "+", 
            RowBox[{"2", " ", "b", " ", "d", " ", 
             SuperscriptBox["t", "4"]}], "+", 
            RowBox[{"2", " ", "b", " ", 
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["t", "4"]}]}], ")"}]}], ")"}]}], ",", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", 
            SuperscriptBox["Cube", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "5"], " ", "Cube", " ", "d"}], "+", 
           RowBox[{
            SuperscriptBox["b", "9"], " ", 
            SuperscriptBox["d", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["Cube", "2"], " ", "t"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "4"], " ", "Cube", " ", "d", " ", "t"}], "+", 
           
           RowBox[{
            SuperscriptBox["b", "8"], " ", 
            SuperscriptBox["d", "2"], " ", "t"}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["b", "4"], " ", "Cube", " ", 
            SuperscriptBox["d", "2"], " ", "t"}], "+", 
           RowBox[{
            SuperscriptBox["Cube", "2"], " ", 
            SuperscriptBox["d", "2"], " ", "t"}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["b", "3"], " ", "Cube", " ", "d", " ", 
            SuperscriptBox["t", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "7"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "2"]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["b", "3"], " ", "Cube", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "7"], " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "2"], " ", "Cube", " ", "d", " ", 
            SuperscriptBox["t", "3"]}], "-", 
           RowBox[{"5", " ", 
            SuperscriptBox["b", "6"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "3"]}], "+", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", "Cube", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "3"]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["b", "6"], " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "3"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", "Cube", " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "3"]}], "+", 
           RowBox[{"b", " ", "Cube", " ", "d", " ", 
            SuperscriptBox["t", "4"]}], "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["b", "5"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "4"]}], "-", 
           RowBox[{"b", " ", "Cube", " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["b", "4"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "5"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "4"], " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "5"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "3"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "6"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "3"], " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "6"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "7"]}], "+", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["d", "4"], " ", 
            SuperscriptBox["t", "7"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "4"], " ", "d", " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["b", "4"], " ", 
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["b", "3"], " ", "d", " ", "t", " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["b", "3"], " ", 
            SuperscriptBox["d", "2"], " ", "t", " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "2"], " ", "d", " ", 
            SuperscriptBox["t", "2"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "2"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "2"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "+", 
           RowBox[{"b", " ", "d", " ", 
            SuperscriptBox["t", "3"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox["d", "3"], " ", 
            SuperscriptBox["t", "3"], " ", 
            RowBox[{"Prism", "[", "5", "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"b", " ", "d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "b"}], "+", 
             RowBox[{"b", " ", "d"}], "+", "t", "-", 
             RowBox[{"d", " ", "t"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["b", "5"], " ", "d"}], "-", 
             RowBox[{"b", " ", "Cube", " ", "d"}], "-", 
             RowBox[{"Cube", " ", "t"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["b", "4"], " ", "d", " ", "t"}], "-", 
             RowBox[{"Cube", " ", "d", " ", "t"}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["b", "3"], " ", "d", " ", 
              SuperscriptBox["t", "2"]}], "+", 
             RowBox[{"2", " ", "b", " ", "d", " ", 
              SuperscriptBox["t", "4"]}], "+", 
             RowBox[{"2", " ", "b", " ", 
              SuperscriptBox["d", "2"], " ", 
              SuperscriptBox["t", "4"]}]}], ")"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["Cube", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"], " ", "Cube", " ", "d"}], "-", 
          RowBox[{
           SuperscriptBox["Cube", "2"], " ", "d"}], "+", 
          RowBox[{
           SuperscriptBox["b", "8"], " ", 
           SuperscriptBox["d", "2"]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "4"], " ", "Cube", " ", 
           SuperscriptBox["d", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["Cube", "2"], " ", 
           SuperscriptBox["d", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["b", "3"], " ", "Cube", " ", "d", " ", "t"}], "+", 
          RowBox[{
           SuperscriptBox["b", "7"], " ", 
           SuperscriptBox["d", "2"], " ", "t"}], "-", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", "Cube", " ", "d", " ", 
           SuperscriptBox["t", "2"]}], "-", 
          RowBox[{"5", " ", 
           SuperscriptBox["b", "6"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "2"], " ", "Cube", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["b", "6"], " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "2"]}], "-", 
          RowBox[{"b", " ", "Cube", " ", "d", " ", 
           SuperscriptBox["t", "3"]}], "+", 
          RowBox[{
           SuperscriptBox["b", "5"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "3"]}], "+", 
          RowBox[{"b", " ", "Cube", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "3"]}], "-", 
          RowBox[{
           SuperscriptBox["b", "5"], " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "3"]}], "+", 
          RowBox[{"2", " ", "Cube", " ", "d", " ", 
           SuperscriptBox["t", "4"]}], "-", 
          RowBox[{
           SuperscriptBox["b", "4"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "4"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"], " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "4"]}], "-", 
          RowBox[{"2", " ", "Cube", " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "4"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "3"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "5"]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "3"], " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "5"]}], "-", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "6"]}], "-", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "6"]}], "-", 
          RowBox[{"b", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "7"]}], "+", 
          RowBox[{"b", " ", 
           SuperscriptBox["d", "4"], " ", 
           SuperscriptBox["t", "7"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "3"], " ", "d", " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["b", "3"], " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", "d", " ", "t", " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["d", "2"], " ", "t", " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "+", 
          RowBox[{"2", " ", "b", " ", "d", " ", 
           SuperscriptBox["t", "2"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "+", 
          RowBox[{"b", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["t", "2"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "-", 
          RowBox[{"b", " ", 
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "2"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "-", 
          RowBox[{"d", " ", 
           SuperscriptBox["t", "3"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["d", "3"], " ", 
           SuperscriptBox["t", "3"], " ", 
           RowBox[{"Prism", "[", "5", "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "b"}], "+", 
            RowBox[{"b", " ", "d"}], "+", "t", "-", 
            RowBox[{"d", " ", "t"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["b", "5"], " ", "d"}], "-", 
            RowBox[{"b", " ", "Cube", " ", "d"}], "-", 
            RowBox[{"Cube", " ", "t"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["b", "4"], " ", "d", " ", "t"}], "-", 
            RowBox[{"Cube", " ", "d", " ", "t"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["b", "3"], " ", "d", " ", 
             SuperscriptBox["t", "2"]}], "+", 
            RowBox[{"2", " ", "b", " ", "d", " ", 
             SuperscriptBox["t", "4"]}], "+", 
            RowBox[{"2", " ", "b", " ", 
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["t", "4"]}]}], ")"}]}], ")"}]}], ",", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["b", "2"]}], " ", "Cube"}], "+", 
           RowBox[{
            SuperscriptBox["b", "6"], " ", "d"}], "+", 
           RowBox[{
            SuperscriptBox["b", "5"], " ", "d", " ", "t"}], "+", 
           RowBox[{"Cube", " ", 
            SuperscriptBox["t", "2"]}], "+", 
           RowBox[{"Cube", " ", "d", " ", 
            SuperscriptBox["t", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", "d", " ", 
            SuperscriptBox["t", "4"]}], "+", 
           RowBox[{"b", " ", "d", " ", 
            SuperscriptBox["t", "5"]}], "+", 
           RowBox[{"b", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "5"]}], "-", 
           RowBox[{"b", " ", "d", " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{"t", " ", 
            RowBox[{"Prism", "[", "5", "]"}]}], "-", 
           RowBox[{"d", " ", "t", " ", 
            RowBox[{"Prism", "[", "5", "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["b", "5"], " ", "d"}], "-", 
           RowBox[{"b", " ", "Cube", " ", "d"}], "-", 
           RowBox[{"Cube", " ", "t"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "4"], " ", "d", " ", "t"}], "-", 
           RowBox[{"Cube", " ", "d", " ", "t"}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["b", "3"], " ", "d", " ", 
            SuperscriptBox["t", "2"]}], "+", 
           RowBox[{"2", " ", "b", " ", "d", " ", 
            SuperscriptBox["t", "4"]}], "+", 
           RowBox[{"2", " ", "b", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["t", "4"]}]}], ")"}]}]}], ",", "1"}], "}"}], "/.", 
     
     RowBox[{"PolyhedraEvaluationRules", "[", "\"\<Deligne\>\"", "]"}]}], "/.", 
    RowBox[{"VariableSubstitutions", "[", "\"\<Deligne\>\"", "]"}]}], "//", 
   "Together"}]}]], "Input",
 CellChangeTimes->{{3.593587848765567*^9, 3.593587848788012*^9}, {
  3.59358789839037*^9, 3.5935879258782463`*^9}, {3.59358839052317*^9, 
  3.5935883978862762`*^9}, {3.5935890922589912`*^9, 3.593589093147129*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["b", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "z", "+", 
        SuperscriptBox["z", "2"], "-", 
        SuperscriptBox["z", "3"], "+", 
        SuperscriptBox["z", "4"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["z", "4"], "+", 
        SuperscriptBox["z", "5"], "+", 
        SuperscriptBox["z", "6"], "+", 
        RowBox[{"d", " ", 
         SuperscriptBox["z", "8"]}], "+", 
        SuperscriptBox["z", "10"], "+", 
        SuperscriptBox["z", "11"], "+", 
        SuperscriptBox["z", "12"]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["z", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "z", "+", 
        SuperscriptBox["z", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          SuperscriptBox["z", "4"]}], "+", 
         SuperscriptBox["z", "8"]}], ")"}], "2"]}]]}], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["b", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["z", "4"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "5"]}], "+", 
       SuperscriptBox["z", "6"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "z"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "2"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["z", "3"]}], "+", 
       RowBox[{"5", " ", 
        SuperscriptBox["z", "4"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["z", "5"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "6"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "7"]}], "+", 
       SuperscriptBox["z", "8"]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "z", "+", 
       SuperscriptBox["z", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         SuperscriptBox["z", "4"]}], "+", 
        SuperscriptBox["z", "8"]}], ")"}], "2"]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["b", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"z", "-", 
       SuperscriptBox["z", "2"], "+", 
       SuperscriptBox["z", "4"], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "5"]}], "+", 
       RowBox[{"5", " ", 
        SuperscriptBox["z", "6"]}], "-", 
       RowBox[{"2", " ", "d", " ", 
        SuperscriptBox["z", "6"]}], "-", 
       RowBox[{"5", " ", 
        SuperscriptBox["z", "7"]}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["z", "7"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "8"]}], "-", 
       RowBox[{"2", " ", "d", " ", 
        SuperscriptBox["z", "9"]}], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "10"]}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["z", "10"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["z", "11"]}], "-", 
       RowBox[{"6", " ", "d", " ", 
        SuperscriptBox["z", "11"]}], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["z", "11"]}], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "12"]}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["z", "12"]}], "-", 
       RowBox[{"2", " ", "d", " ", 
        SuperscriptBox["z", "13"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["z", "14"]}], "-", 
       RowBox[{"5", " ", 
        SuperscriptBox["z", "15"]}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["z", "15"]}], "+", 
       RowBox[{"5", " ", 
        SuperscriptBox["z", "16"]}], "-", 
       RowBox[{"2", " ", "d", " ", 
        SuperscriptBox["z", "16"]}], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["z", "17"]}], "+", 
       SuperscriptBox["z", "18"], "-", 
       SuperscriptBox["z", "20"], "+", 
       SuperscriptBox["z", "21"]}], ")"}]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["z", "2"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z", "+", 
       SuperscriptBox["z", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         SuperscriptBox["z", "4"]}], "+", 
        SuperscriptBox["z", "8"]}], ")"}], "2"]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "z", "+", 
        SuperscriptBox["z", "2"], "-", 
        SuperscriptBox["z", "3"], "+", 
        SuperscriptBox["z", "4"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"z", "+", 
        SuperscriptBox["z", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["z", "4"]}], "+", 
        SuperscriptBox["z", "5"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "6"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "7"]}], "+", 
        RowBox[{"2", " ", "d", " ", 
         SuperscriptBox["z", "8"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "9"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "10"]}], "+", 
        SuperscriptBox["z", "11"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["z", "12"]}], "+", 
        SuperscriptBox["z", "14"], "+", 
        SuperscriptBox["z", "15"]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["z", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "z", "+", 
        SuperscriptBox["z", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          SuperscriptBox["z", "4"]}], "+", 
         SuperscriptBox["z", "8"]}], ")"}], "2"]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "z"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "2"]}], "-", 
        SuperscriptBox["z", "3"], "-", 
        SuperscriptBox["z", "4"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "5"]}], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["z", "6"]}], "+", 
        RowBox[{"d", " ", 
         SuperscriptBox["z", "6"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "7"]}], "-", 
        SuperscriptBox["z", "8"], "-", 
        SuperscriptBox["z", "9"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "10"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["z", "11"]}], "+", 
        SuperscriptBox["z", "12"]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["z", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "z", "+", 
        SuperscriptBox["z", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         SuperscriptBox["z", "4"]}], "+", 
        SuperscriptBox["z", "8"]}], ")"}]}]]}], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.593587877442214*^9, 3.593587928014126*^9}, 
   3.5935884010545797`*^9, 3.593589095524634*^9, 3.59373675701451*^9, 
   3.5940006190236673`*^9, 3.594000920647348*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "RR", "]"}]], "Input",
 CellChangeTimes->{{3.5935884209078903`*^9, 3.593588422326212*^9}}],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{3.593588422750396*^9, 3.59358909836709*^9, 
  3.5937367571982527`*^9, 3.5940006192111588`*^9, 3.594000921108735*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"relation", "=", 
  RowBox[{"RR", ".", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"Diagrams", "[", 
      RowBox[{"4", ",", 
       RowBox[{"_", "\[LessEqual]", "2"}]}], "]"}], ",", "6"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.593588095816374*^9, 3.593588098309857*^9}, {
  3.593588405132399*^9, 3.5935884270544043`*^9}, {3.593588867046649*^9, 
  3.5935888691605988`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["z", "4"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "5"]}], "+", 
      SuperscriptBox["z", "6"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "z"}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["z", "2"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["z", "3"]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["z", "4"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["z", "5"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["z", "6"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "7"]}], "+", 
      SuperscriptBox["z", "8"]}], ")"}], " ", 
    RowBox[{"Diagram", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "10000000", ",", "10000001", ",", "10000002", ",", "10000003"}], "}"}],
       ",", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"10000000", ",", "10000003"}], "]"}], " ", 
       RowBox[{"P", "[", 
        RowBox[{"10000001", ",", "10000002"}], "]"}]}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "z", "+", 
      SuperscriptBox["z", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["z", "4"]}], "+", 
       SuperscriptBox["z", "8"]}], ")"}], "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "z", "+", 
      SuperscriptBox["z", "2"], "-", 
      SuperscriptBox["z", "3"], "+", 
      SuperscriptBox["z", "4"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["z", "4"], "+", 
      SuperscriptBox["z", "5"], "+", 
      SuperscriptBox["z", "6"], "+", 
      RowBox[{"d", " ", 
       SuperscriptBox["z", "8"]}], "+", 
      SuperscriptBox["z", "10"], "+", 
      SuperscriptBox["z", "11"], "+", 
      SuperscriptBox["z", "12"]}], ")"}], " ", 
    RowBox[{"Diagram", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "10000000", ",", "10000001", ",", "10000002", ",", "10000003"}], "}"}],
       ",", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"10000000", ",", "10000001"}], "]"}], " ", 
       RowBox[{"P", "[", 
        RowBox[{"10000002", ",", "10000003"}], "]"}]}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["z", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "z", "+", 
      SuperscriptBox["z", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["z", "4"]}], "+", 
       SuperscriptBox["z", "8"]}], ")"}], "2"]}]], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["z", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z", "+", 
       SuperscriptBox["z", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         SuperscriptBox["z", "4"]}], "+", 
        SuperscriptBox["z", "8"]}], ")"}], "2"]}]], 
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "z", "+", 
      SuperscriptBox["z", "2"], "-", 
      SuperscriptBox["z", "3"], "+", 
      SuperscriptBox["z", "4"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"z", "+", 
      SuperscriptBox["z", "2"], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["z", "4"]}], "+", 
      SuperscriptBox["z", "5"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "6"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "7"]}], "+", 
      RowBox[{"2", " ", "d", " ", 
       SuperscriptBox["z", "8"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "9"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "10"]}], "+", 
      SuperscriptBox["z", "11"], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["z", "12"]}], "+", 
      SuperscriptBox["z", "14"], "+", 
      SuperscriptBox["z", "15"]}], ")"}], " ", 
    RowBox[{"Diagram", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "10000000", ",", "10000001", ",", "10000002", ",", "10000003"}], "}"}],
       ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"10000000", ",", "10000004", ",", "10000003"}], "]"}], " ", 
       RowBox[{"Y", "[", 
        RowBox[{"10000001", ",", "10000002", ",", "10000004"}], "]"}]}]}], 
     "]"}]}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["z", "2"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z", "+", 
       SuperscriptBox["z", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         SuperscriptBox["z", "4"]}], "+", 
        SuperscriptBox["z", "8"]}], ")"}], "2"]}]], 
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"z", "-", 
      SuperscriptBox["z", "2"], "+", 
      SuperscriptBox["z", "4"], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["z", "5"]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["z", "6"]}], "-", 
      RowBox[{"2", " ", "d", " ", 
       SuperscriptBox["z", "6"]}], "-", 
      RowBox[{"5", " ", 
       SuperscriptBox["z", "7"]}], "+", 
      RowBox[{"d", " ", 
       SuperscriptBox["z", "7"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "8"]}], "-", 
      RowBox[{"2", " ", "d", " ", 
       SuperscriptBox["z", "9"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["z", "10"]}], "+", 
      RowBox[{"d", " ", 
       SuperscriptBox["z", "10"]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["z", "11"]}], "-", 
      RowBox[{"6", " ", "d", " ", 
       SuperscriptBox["z", "11"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["z", "11"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["z", "12"]}], "+", 
      RowBox[{"d", " ", 
       SuperscriptBox["z", "12"]}], "-", 
      RowBox[{"2", " ", "d", " ", 
       SuperscriptBox["z", "13"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "14"]}], "-", 
      RowBox[{"5", " ", 
       SuperscriptBox["z", "15"]}], "+", 
      RowBox[{"d", " ", 
       SuperscriptBox["z", "15"]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["z", "16"]}], "-", 
      RowBox[{"2", " ", "d", " ", 
       SuperscriptBox["z", "16"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["z", "17"]}], "+", 
      SuperscriptBox["z", "18"], "-", 
      SuperscriptBox["z", "20"], "+", 
      SuperscriptBox["z", "21"]}], ")"}], " ", 
    RowBox[{"Diagram", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "10000000", ",", "10000001", ",", "10000002", ",", "10000003"}], "}"}],
       ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"10000000", ",", "10000001", ",", "10000004"}], "]"}], " ", 
       RowBox[{"Y", "[", 
        RowBox[{"10000002", ",", "10000003", ",", "10000004"}], "]"}]}]}], 
     "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["z", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z", "+", 
       SuperscriptBox["z", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["z", "4"]}], "+", 
       SuperscriptBox["z", "8"]}], ")"}]}]], 
   RowBox[{"b", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "z"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"]}], "-", 
      SuperscriptBox["z", "3"], "-", 
      SuperscriptBox["z", "4"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "5"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["z", "6"]}], "+", 
      RowBox[{"d", " ", 
       SuperscriptBox["z", "6"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "7"]}], "-", 
      SuperscriptBox["z", "8"], "-", 
      SuperscriptBox["z", "9"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "10"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "11"]}], "+", 
      SuperscriptBox["z", "12"]}], ")"}], " ", 
    RowBox[{"Diagram", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "10000000", ",", "10000001", ",", "10000002", ",", "10000003"}], "}"}],
       ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"10000000", ",", "10000004", ",", "10000005"}], "]"}], " ", 
       RowBox[{"Y", "[", 
        RowBox[{"10000001", ",", "10000006", ",", "10000004"}], "]"}], " ", 
       RowBox[{"Y", "[", 
        RowBox[{"10000002", ",", "10000007", ",", "10000006"}], "]"}], " ", 
       RowBox[{"Y", "[", 
        RowBox[{"10000003", ",", "10000005", ",", "10000007"}], "]"}]}]}], 
     "]"}]}]}], "+", 
  RowBox[{"Diagram", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10000000", ",", "10000001", ",", "10000002", ",", "10000003"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"Y", "[", 
      RowBox[{"10000000", ",", "10000004", ",", "10000005"}], "]"}], " ", 
     RowBox[{"Y", "[", 
      RowBox[{"10000001", ",", "10000006", ",", "10000004"}], "]"}], " ", 
     RowBox[{"Y", "[", 
      RowBox[{"10000002", ",", "10000007", ",", "10000008"}], "]"}], " ", 
     RowBox[{"Y", "[", 
      RowBox[{"10000003", ",", "10000009", ",", "10000007"}], "]"}], " ", 
     RowBox[{"Y", "[", 
      RowBox[{"10000005", ",", "10000010", ",", "10000009"}], "]"}], " ", 
     RowBox[{"Y", "[", 
      RowBox[{"10000006", ",", "10000008", ",", "10000010"}], "]"}]}]}], 
   "]"}]}]], "Output",
 CellChangeTimes->{
  3.593588098760936*^9, {3.593588410523075*^9, 3.5935884274472437`*^9}, 
   3.593588824045149*^9, 3.593588869698585*^9, 3.593589099322068*^9, 
   3.593589375399091*^9, 3.593736757302964*^9, 3.5940006193229017`*^9, 
   3.594000921210526*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{"relation", " ", 
     RowBox[{"Diagram", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10000001", ",", "10000000"}], "}"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"10000001", ",", "10000000"}], "]"}]}], "]"}]}], "]"}], ",", 
   "_Diagram", ",", "Together"}], "]"}]], "Input",
 CellChangeTimes->{{3.5935888381024923`*^9, 3.593588913220314*^9}, {
  3.5935897864751596`*^9, 3.593589793020878*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.593589793870318*^9, 3.593736757586295*^9, 
  3.594000619596249*^9, 3.5940009214265842`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Diagram", "[", 
   RowBox[{"_", ",", "0"}], "]"}], ":=", "0"}]], "Input",
 CellChangeTimes->{{3.593588952155024*^9, 3.593588956467834*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Diagram", "[", 
   RowBox[{"bdy_", ",", 
    RowBox[{
     SuperscriptBox["d", "k_."], " ", "X_."}]}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["d", "k"], 
   RowBox[{"Diagram", "[", 
    RowBox[{"bdy", ",", "X"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diagram", "[", 
   RowBox[{"bdy_", ",", 
    RowBox[{
     SuperscriptBox["b", "k_."], " ", "X_."}]}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["b", "k"], 
   RowBox[{"Diagram", "[", 
    RowBox[{"bdy", ",", "X"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diagram", "[", 
   RowBox[{"bdy_", ",", 
    RowBox[{
     SuperscriptBox["t", "k_."], " ", "X_."}]}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["t", "k"], 
   RowBox[{"Diagram", "[", 
    RowBox[{"bdy", ",", "X"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.593588962626276*^9, 3.5935890025522614`*^9}, {
  3.593591175606989*^9, 3.5935911775190277`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"YY", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k1", "=", "freshLabel"}], ",", 
      RowBox[{"k2", "=", "freshLabel"}], ",", 
      RowBox[{"k3", "=", "freshLabel"}]}], "}"}], ",", 
    RowBox[{"Diagram", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", 
      RowBox[{"Y", "[", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5935901156013317`*^9, 3.593590142740945*^9}, {
  3.593590867489132*^9, 3.5935908878153877`*^9}}],

Cell[BoxData[
 RowBox[{"Diagram", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"10051", ",", "10052", ",", "10053"}], "}"}], ",", 
   RowBox[{"Y", "[", 
    RowBox[{"10051", ",", "10052", ",", "10053"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.593590137496414*^9, 3.5935901431939077`*^9}, 
   3.5935908884526997`*^9, 3.593736757666904*^9, 3.594000619705076*^9, 
   3.594000921524582*^9, {3.5947611114287863`*^9, 3.594761115556261*^9}, 
   3.594779992667341*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"shiftLabels", "[", 
   RowBox[{
    RowBox[{"Diagram", "[", 
     RowBox[{"boundary_", ",", "contents_"}], "]"}], ",", "k_"}], "]"}], ":=", 
  RowBox[{"Diagram", "[", 
   RowBox[{
    RowBox[{"boundary", "+", "k"}], ",", 
    RowBox[{"contents", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"P", "[", 
         RowBox[{
          RowBox[{"a", "+", "k"}], ",", 
          RowBox[{"b", "+", "k"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"Y", "[", 
         RowBox[{
          RowBox[{"a", "+", "k"}], ",", 
          RowBox[{"b", "+", "k"}], ",", 
          RowBox[{"c", "+", "k"}]}], "]"}]}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.593590915123082*^9, 3.593590965289771*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "Stitch", "]"}]], "Input",
 CellChangeTimes->{{3.5935910849870853`*^9, 3.593591087773633*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Stitch", "[", 
    RowBox[{"diagram1_Diagram", ",", "diagram2_Diagram", ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Min", "[", 
     RowBox[{"labels", "[", "diagram2", "]"}], "]"}], "\[LessEqual]", 
    RowBox[{"Max", "[", 
     RowBox[{"labels", "[", "diagram1", "]"}], "]"}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Stitch", "[", 
   RowBox[{"diagram1", ",", 
    RowBox[{"shiftLabels", "[", 
     RowBox[{"diagram2", ",", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"labels", "[", "diagram1", "]"}], "]"}], "-", 
       RowBox[{"Min", "[", 
        RowBox[{"labels", "[", "diagram2", "]"}], "]"}], "+", "1"}]}], "]"}], 
    ",", "k"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5935906944358597`*^9, 3.5935907022108107`*^9}, {
   3.5935907363606358`*^9, 3.593590857388803*^9}, {3.593591010567072*^9, 
   3.593591082796678*^9}, {3.5935912060295277`*^9, 3.5935912077003803`*^9}, 
   3.593591763160276*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Stitch", "[", 
    RowBox[{"diagram1_Diagram", ",", "diagram2_Diagram", ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Min", "[", 
     RowBox[{"labels", "[", "diagram2", "]"}], "]"}], ">", 
    RowBox[{"Max", "[", 
     RowBox[{"labels", "[", "diagram1", "]"}], "]"}]}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Stitching \>\"", ",", "k", ",", "\"\< points of \>\"", ",", 
        "diagram1", ",", "\"\< with \>\"", ",", "diagram2"}], "]"}], ";"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Unfortunately", " ", "this", " ", "multiplication", " ", "trick", " ", 
      RowBox[{"doesn", "'"}], "t", " ", "make", " ", "any", " ", "guarantees",
       " ", "about", " ", "where", " ", "the", " ", "star", " ", "ends", " ", 
      
      RowBox[{"up", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{"diagram1", " ", "diagram2", " ", 
       RowBox[{"Diagram", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{
             "diagram1", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", "k"}], "]"}], "]"}], "~", 
          "Join", "~", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{
             "diagram2", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"-", "k"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{
             RowBox[{"diagram1", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"diagram2", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", 
               RowBox[{"-", "m"}]}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", "k"}], "}"}]}], "]"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"result", "=!=", "0"}], "\[And]", 
         RowBox[{"k", " ", "<", 
          RowBox[{"Length", "[", 
           RowBox[{
           "diagram1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"result", ",", 
           RowBox[{
            RowBox[{"Diagram", "[", 
             RowBox[{"bdy_", ",", "_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"bdy", ",", 
               RowBox[{"diagram1", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", 
                 RowBox[{"k", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
              "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Infinity]"}], "}"}], ",", "1"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RotateDiagram", "[", 
      RowBox[{"result", ",", 
       RowBox[{
        RowBox[{"-", "p"}], "+", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5935906944358597`*^9, 3.5935907022108107`*^9}, {
  3.5935907363606358`*^9, 3.593590857388803*^9}, {3.593591010567072*^9, 
  3.593591082796678*^9}, {3.593591154087123*^9, 3.5935911583305607`*^9}, {
  3.5935911985089273`*^9, 3.593591202329192*^9}, {3.593591286910445*^9, 
  3.5935912917566013`*^9}, {3.593593876739818*^9, 3.5935939081983643`*^9}, {
  3.593593955143599*^9, 3.593594132800556*^9}, {3.5935941872862797`*^9, 
  3.593594188112555*^9}, {3.5935942350618*^9, 3.593594260380122*^9}, {
  3.594761180491291*^9, 3.594761201306738*^9}, {3.594761275622913*^9, 
  3.594761311145259*^9}, {3.594761381409412*^9, 3.594761383822557*^9}, {
  3.594762278742708*^9, 3.5947623035848083`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotateDiagram", "[", 
   RowBox[{
    RowBox[{"Diagram", "[", 
     RowBox[{"boundary_", ",", "contents_"}], "]"}], ",", 
    RowBox[{"k_Integer:", "1"}]}], "]"}], ":=", 
  RowBox[{"canonicalLabelling", "[", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"RotateLeft", "[", 
      RowBox[{"boundary", ",", "k"}], "]"}], ",", "contents"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5935927333876133`*^9, 3.5935928097081747`*^9}, {
  3.593592965650853*^9, 3.593592967245535*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RotateDiagram", "[", 
   RowBox[{"X_Plus", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"RotateDiagram", "[", 
     RowBox[{"#", ",", "k"}], "]"}], "&"}], "/@", 
   "X"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotateDiagram", "[", 
   RowBox[{
    RowBox[{"a_", " ", "d_Diagram"}], ",", "k_"}], "]"}], ":=", 
  RowBox[{"a", " ", 
   RowBox[{"RotateDiagram", "[", 
    RowBox[{"d", ",", "k"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotateDiagram", "[", 
   RowBox[{"0", ",", "_"}], "]"}], ":=", "0"}]}], "Input",
 CellChangeTimes->{{3.593592988086005*^9, 3.593593018683906*^9}, {
  3.593594220269247*^9, 3.593594224528652*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Stitch", "[", 
   RowBox[{"X_Plus", ",", "Y_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Stitch", "[", 
       RowBox[{"#", ",", "Y", ",", "k"}], "]"}], "&"}], "/@", "X"}], ",", 
    "_Diagram"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Stitch", "[", 
   RowBox[{"X_", ",", "Y_Plus", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Stitch", "[", 
       RowBox[{"X", ",", "#", ",", "k"}], "]"}], "&"}], "/@", "Y"}], ",", 
    "_Diagram"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Stitch", "[", 
   RowBox[{
    RowBox[{"a_", " ", "d_Diagram"}], ",", "Y_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"a", " ", 
   RowBox[{"Stitch", "[", 
    RowBox[{"d", ",", "Y", ",", "k"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Stitch", "[", 
   RowBox[{"X_", ",", 
    RowBox[{"a_", " ", "d_Diagram"}], ",", "k_"}], "]"}], ":=", 
  RowBox[{"a", " ", 
   RowBox[{"Stitch", "[", 
    RowBox[{"X", ",", "d", ",", "k"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.5935913379802322`*^9, 3.593591418907185*^9}, {
  3.593591456487794*^9, 3.5935915416256447`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Stitch", "[", 
  RowBox[{"YY", ",", "YY", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.5935910908536577`*^9, 3.593591125548918*^9}, {
  3.593591163925528*^9, 3.59359116400436*^9}, {3.5935913311050177`*^9, 
  3.593591331194179*^9}, {3.5935941495046253`*^9, 3.593594149586554*^9}}],

Cell[BoxData[
 RowBox[{"Diagram", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"10000000", ",", "10000001", ",", "10000002", ",", "10000003"}], 
    "}"}], ",", 
   RowBox[{
    RowBox[{"Y", "[", 
     RowBox[{"10000000", ",", "10000001", ",", "10000004"}], "]"}], " ", 
    RowBox[{"Y", "[", 
     RowBox[{"10000002", ",", "10000003", ",", "10000004"}], "]"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.5935910949488*^9, 3.593591125936298*^9}, {
   3.593591160980929*^9, 3.593591179682659*^9}, 3.593591210432027*^9, 
   3.5935912936095123`*^9, {3.593591328204129*^9, 3.59359133151397*^9}, 
   3.593591420975918*^9, 3.593591460834486*^9, 3.593591772253994*^9, {
   3.593594139531884*^9, 3.593594150143442*^9}, 3.593594263371237*^9, {
   3.5937367585723543`*^9, 3.593736786546116*^9}, 3.5940006203437138`*^9, 
   3.594000922298869*^9, {3.594761107369895*^9, 3.594761120670988*^9}, 
   3.594779993068351*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Stitch", "[", 
  RowBox[{"YY", ",", "YY", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.5935910908536577`*^9, 3.593591125548918*^9}, {
  3.593591163925528*^9, 3.59359116400436*^9}, {3.5935913311050177`*^9, 
  3.593591331194179*^9}}],

Cell[BoxData[
 RowBox[{"b", " ", 
  RowBox[{"Diagram", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10000000", ",", "10000001"}], "}"}], ",", 
    RowBox[{"P", "[", 
     RowBox[{"10000000", ",", "10000001"}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.593594147101843*^9, 3.5935942641231203`*^9, 3.593736758643093*^9, 
   3.593736789054881*^9, 3.594000620471292*^9, 3.59400092240865*^9, {
   3.594761107407812*^9, 3.5947611207107763`*^9}, 3.594779993125759*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Stitch", "[", 
  RowBox[{"YY", ",", "YY", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.5935910908536577`*^9, 3.593591125548918*^9}, {
  3.593591163925528*^9, 3.59359116400436*^9}, {3.5935913311050177`*^9, 
  3.593591331194179*^9}, {3.593594154190537*^9, 3.593594154265294*^9}}],

Cell[BoxData[
 RowBox[{"b", " ", "d", " ", 
  RowBox[{"Diagram", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "1"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.593594154655867*^9, 3.593594264691263*^9, 3.593736758743906*^9, 
   3.5937367908755913`*^9, 3.594000620590292*^9, 3.5940009225178556`*^9, {
   3.594761107459202*^9, 3.594761120787724*^9}, 3.5947799931758013`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Stitch", "[", 
    RowBox[{"relation", ",", "YY", ",", "2"}], "]"}], "/.", 
   RowBox[{"VariableSubstitutions", "[", "\"\<Deligne\>\"", "]"}]}], "//", 
  "Together"}]], "Input",
 CellChangeTimes->{{3.5935916471776447`*^9, 3.5935916684565487`*^9}, {
  3.593591777021462*^9, 3.593591796718656*^9}}],

Cell[BoxData[
 RowBox[{"Stitch", "[", 
  RowBox[{"relation", ",", "YY", ",", "2"}], "]"}]], "Output",
 CellChangeTimes->{{3.593591657708354*^9, 3.593591674728462*^9}, {
   3.593591774516358*^9, 3.59359179707202*^9}, 3.593594158035862*^9, {
   3.5935942272390127`*^9, 3.593594265381227*^9}, 3.593736758962062*^9, 
   3.593736792903636*^9, 3.594761107506022*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rforks", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RotateDiagram", "[", 
       RowBox[{
        RowBox[{"Stitch", "[", 
         RowBox[{
          RowBox[{"RotateDiagram", "[", 
           RowBox[{"relation", ",", "k1"}], "]"}], ",", "YY", ",", "1"}], 
         "]"}], ",", "k2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k2", ",", "0", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.593592812287077*^9, 3.593592876130631*^9}, {
   3.593592976018746*^9, 3.5935929848132277`*^9}, 3.593593024510496*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Diagrams", "[", 
  RowBox[{"5", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.593593383889845*^9, 3.5935933860142183`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"10000003", ",", "10000004"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000000", ",", "10000001", ",", "10000002"}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"10000000", ",", "10000004"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000001", ",", "10000002", ",", "10000003"}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"10000000", ",", "10000001"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000002", ",", "10000003", ",", "10000004"}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"10000001", ",", "10000002"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000000", ",", "10000003", ",", "10000004"}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"10000002", ",", "10000003"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000000", ",", "10000001", ",", "10000004"}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"10000000", ",", "10000001", ",", "10000005"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000002", ",", "10000006", ",", "10000005"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000003", ",", "10000004", ",", "10000006"}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"10000000", ",", "10000005", ",", "10000006"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000001", ",", "10000002", ",", "10000005"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000003", ",", "10000004", ",", "10000006"}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"10000000", ",", "10000001", ",", "10000005"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000002", ",", "10000003", ",", "10000006"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000004", ",", "10000005", ",", "10000006"}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"10000000", ",", "10000005", ",", "10000004"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000001", ",", "10000002", ",", "10000006"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000003", ",", "10000005", ",", "10000006"}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"Diagram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10000000", ",", "10000001", ",", "10000002", ",", "10000003", ",", 
       "10000004"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"10000000", ",", "10000005", ",", "10000004"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000001", ",", "10000006", ",", "10000005"}], "]"}], " ", 
      RowBox[{"Y", "[", 
       RowBox[{"10000002", ",", "10000003", ",", "10000006"}], "]"}]}]}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.593593386683807*^9, 3.5935942714455357`*^9, 
  3.59373675975963*^9, 3.5937367964656153`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"gluing", " ", "a", " ", "tree", " ", "on"}], " ", "*)"}]], "Input",\

 CellChangeTimes->{{3.593595080345134*^9, 3.5935950886998158`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rb", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RotateDiagram", "[", 
        RowBox[{
         RowBox[{"Stitch", "[", 
          RowBox[{
           RowBox[{"RotateDiagram", "[", 
            RowBox[{"relation", ",", "k1"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Diagrams", "[", 
             RowBox[{"5", ",", "0"}], "]"}], "\[LeftDoubleBracket]", "10", 
            "\[RightDoubleBracket]"}], ",", "2"}], "]"}], ",", "k2"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", "0", ",", "4"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"VariableSubstitutions", "[", "\"\<Deligne\>\"", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.593593346017839*^9, 3.593593347950719*^9}, {
   3.5935935262681313`*^9, 3.593593538163476*^9}, 3.593593569341675*^9, 
   3.59359360684057*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"two", " ", "copies", " ", "of", " ", "the", " ", "relation"}], " ",
   "*)"}]], "Input",
 CellChangeTimes->{{3.5937367454525633`*^9, 3.5937367504324093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rz", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RotateDiagram", "[", 
        RowBox[{
         RowBox[{"Stitch", "[", 
          RowBox[{
           RowBox[{"RotateDiagram", "[", 
            RowBox[{
             RowBox[{"Stitch", "[", 
              RowBox[{
               RowBox[{"RotateDiagram", "[", 
                RowBox[{"relation", ",", "k1"}], "]"}], ",", 
               RowBox[{"RotateDiagram", "[", 
                RowBox[{"relation", ",", "k1"}], "]"}], ",", "1"}], "]"}], 
             ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", "YY", ",", "2"}], "]"}], ",", 
         "k4"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k4", ",", "0", ",", "4"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"VariableSubstitutions", "[", "\"\<Deligne\>\"", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5935952020800247`*^9, 3.593595284271244*^9}, 
   3.5935955723530617`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Faces", "/@", 
    RowBox[{"Union", "[", 
     RowBox[{"Cases", "[", 
      RowBox[{"Rz", ",", "_Diagram", ",", "\[Infinity]"}], "]"}], "]"}]}], 
   ")"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"_PartialFace", "\[RuleDelayed]", 
     RowBox[{"Sequence", "[", "]"}]}], ",", 
    RowBox[{"f_Face", "\[RuleDelayed]", 
     RowBox[{"Length", "[", "f", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.593737100439842*^9, 3.5937371476453867`*^9}, {
  3.5937371801565237`*^9, 3.5937371808198442`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "5", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "7"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.59373710387187*^9, 3.593737150814199*^9}, 
   3.5937372033873653`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DiagramsWithoutAdjacentSquares", "[", 
   RowBox[{"5", ",", 
    RowBox[{"_", "\[LessEqual]", "2"}]}], "]"}], "//", "Length"}]], "Input",
 CellChangeTimes->{{3.5935953776283627`*^9, 3.593595417047613*^9}}],

Cell[BoxData["21"], "Output",
 CellChangeTimes->{{3.59359538543358*^9, 3.5935954174389133`*^9}, 
   3.593736775173234*^9, 3.593736808092037*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveDuplicates", "[", "X_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "x", "]"}], "=", 
         RowBox[{"Sequence", "[", "]"}]}], ";", "x"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "/@", "X"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.593595430657063*^9, 3.593595461668508*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"diagrams", "=", 
    RowBox[{"RemoveDuplicates", "[", 
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DiagramsWithoutAdjacentSquares", "[", 
         RowBox[{"5", ",", 
          RowBox[{"_", "\[LessEqual]", "2"}]}], "]"}], "~", "Join", "~", 
        "Rforks", "~", "Join", "~", "Rb", "~", "Join", "~", "Rz"}], ",", 
       "_Diagram", ",", "\[Infinity]"}], "]"}], "]"}]}], ")"}], "//", 
  "Length"}]], "Input",
 CellChangeTimes->{{3.593593638092013*^9, 3.593593639589066*^9}, {
  3.5935952898829393`*^9, 3.593595291928947*^9}, {3.59359548670634*^9, 
  3.593595528786021*^9}}],

Cell[BoxData["101"], "Output",
 CellChangeTimes->{
  3.593593640126239*^9, 3.593594275754558*^9, 3.5935953026559563`*^9, {
   3.5935954966217213`*^9, 3.5935955292286863`*^9}, 3.593736808220008*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"relations", "=", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{"Rforks", "~", "Join", "~", "Rb", "~", "Join", "~", "Rz"}], ",", 
     "diagrams"}], "]"}], "\[LeftDoubleBracket]", "2", 
   "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.59359311353006*^9, 3.5935931637719183`*^9}, {
   3.59359319950548*^9, 3.593593202291472*^9}, 3.593593322401278*^9, {
   3.593593576389175*^9, 3.593593580582079*^9}, {3.593593625156725*^9, 
   3.59359364562904*^9}, {3.593595107614151*^9, 3.593595137604752*^9}, {
   3.593595300736205*^9, 3.593595302947235*^9}, {3.593595521628484*^9, 
   3.5935955430154743`*^9}, {3.59373708245161*^9, 3.59373708324547*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"SparseArray", "[", 
   RowBox[{
    InterpretationBox[
     RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "680", 
      "\[InvisibleSpace]", "\<\">\"\>"}],
     SequenceForm["<", 680, ">"],
     Editable->False], ",", 
    RowBox[{"{", 
     RowBox[{"40", ",", "101"}], "}"}]}], "]"}],
  False,
  Editable->False]], "Output",
 CellChangeTimes->{{3.5935951379712973`*^9, 3.593595147648628*^9}, 
   3.593595305132584*^9, {3.59359552305659*^9, 3.5935955515495863`*^9}, {
   3.593736812175465*^9, 3.593736828857565*^9}, 3.59373708388131*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", 
  RowBox[{"IdentityMatrix", "[", "n", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", "basis_", "}"}]}], "]"}], ":=", "basis"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{"_", ",", 
      RowBox[{"{", "}"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{"basis1_", ",", "basis2_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "V", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"NullSpace", "/@", 
         RowBox[{"{", 
          RowBox[{"basis1", ",", "basis2"}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "V", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"NullSpace", "[", "V", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.4831861361256332`*^9, 3.483186202852621*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{"basis1_", ",", "basis2_", ",", "bases__"}], "}"}]}], "]"}], ":=", 
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n", ",", 
    RowBox[{"{", 
     RowBox[{"basis1", ",", 
      RowBox[{"IntersectSubspaces", "[", 
       RowBox[{"n", ",", 
        RowBox[{"{", 
         RowBox[{"basis2", ",", "bases"}], "}"}]}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subspace", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"UnitVector", "[", 
      RowBox[{
       RowBox[{"Length", "[", "diagrams", "]"}], ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"DiagramsWithoutAdjacentSquares", "[", 
         RowBox[{"5", ",", 
          RowBox[{"_", "\[LessEqual]", "2"}]}], "]"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5937369992901497`*^9, 3.5937370410795727`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IntersectSubspaces", "[", 
  RowBox[{"101", ",", 
   RowBox[{"{", 
    RowBox[{"subspace", ",", 
     RowBox[{
      RowBox[{"Normal", "[", "relations", "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b", "\[Rule]", "1"}], ",", 
        RowBox[{"d", "\[Rule]", "17"}], ",", 
        RowBox[{"z", "\[Rule]", "2"}]}], "}"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.593737042605069*^9, 3.593737091350089*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.593737091965234*^9}]
}, Open  ]]
},
WindowSize->{1440, 781},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 24615, 597, 374, "Input"],
Cell[25197, 621, 7332, 219, 163, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32566, 845, 128, 2, 28, "Input"],
Cell[32697, 849, 164, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32898, 856, 414, 11, 28, "Input"],
Cell[33315, 869, 10039, 301, 343, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43391, 1175, 507, 13, 28, "Input"],
Cell[43901, 1190, 141, 2, 28, "Output"]
}, Open  ]],
Cell[44057, 1195, 174, 4, 28, "Input"],
Cell[44234, 1201, 939, 29, 79, "Input"],
Cell[CellGroupData[{
Cell[45198, 1234, 603, 17, 28, "Input"],
Cell[45804, 1253, 471, 10, 28, "Output"]
}, Open  ]],
Cell[46290, 1266, 951, 27, 28, "Input"],
Cell[47244, 1295, 131, 2, 28, "Input"],
Cell[47378, 1299, 984, 24, 46, "Input"],
Cell[48365, 1325, 4430, 104, 182, "Input"],
Cell[52798, 1431, 530, 14, 28, "Input"],
Cell[53331, 1447, 706, 20, 63, "Input"],
Cell[54040, 1469, 1246, 36, 80, "Input"],
Cell[CellGroupData[{
Cell[55311, 1509, 309, 5, 28, "Input"],
Cell[55623, 1516, 912, 19, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56572, 1540, 261, 5, 28, "Input"],
Cell[56836, 1547, 477, 11, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57350, 1563, 307, 5, 28, "Input"],
Cell[57660, 1570, 375, 8, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58072, 1583, 343, 8, 28, "Input"],
Cell[58418, 1593, 360, 6, 28, "Output"]
}, Open  ]],
Cell[58793, 1602, 703, 19, 28, "Input"],
Cell[CellGroupData[{
Cell[59521, 1625, 152, 3, 28, "Input"],
Cell[59676, 1630, 4747, 134, 182, "Output"]
}, Open  ]],
Cell[64438, 1767, 183, 4, 28, "Input"],
Cell[64624, 1773, 992, 26, 28, "Input"],
Cell[65619, 1801, 204, 4, 28, "Input"],
Cell[65826, 1807, 1155, 31, 63, "Input"],
Cell[CellGroupData[{
Cell[67006, 1842, 559, 15, 28, "Input"],
Cell[67568, 1859, 6758, 191, 131, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74363, 2055, 240, 5, 28, "Input"],
Cell[74606, 2062, 144, 2, 28, "Output"]
}, Open  ]],
Cell[74765, 2067, 585, 16, 80, "Input"],
Cell[CellGroupData[{
Cell[75375, 2087, 657, 16, 28, "Input"],
Cell[76035, 2105, 197, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76269, 2113, 709, 13, 28, "Input"],
Cell[76981, 2128, 567, 15, 28, "Output"]
}, Open  ]],
Cell[77563, 2146, 181, 5, 28, "Input"],
Cell[77747, 2153, 154, 4, 28, "Input"],
Cell[77904, 2159, 425, 14, 46, "Input"],
Cell[78332, 2175, 975, 27, 148, "Input"],
Cell[79310, 2204, 473, 14, 28, "Input"],
Cell[79786, 2220, 555, 15, 28, "Input"],
Cell[CellGroupData[{
Cell[80366, 2239, 461, 12, 28, "Input"],
Cell[80830, 2253, 87, 2, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
